<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Graphium C++: graphium/graphium_cpp/labels.cpp File Reference</title>
<link rel="icon" href="logo-mini-dark.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo-mini-white-doxygen.png"/></td>
  <td id="projectalign">
   <div id="projectname">Graphium C++<span id="projectnumber">&#160;3.0.0</span>
   </div>
   <div id="projectbrief">C++ accelerations of Graphium&#39;s featurization and data loading processes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ac24bae3a88a7603cf2c130a1fec516d.html">graphium</a></li><li class="navelem"><a class="el" href="dir_5080f134d77f9705307efbfb3bc63636.html">graphium_cpp</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">labels.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;labels.h&quot;</code><br />
<code>#include &quot;features.h&quot;</code><br />
<code>#include &lt;filesystem&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;GraphMol/ROMol.h&gt;</code><br />
<code>#include &lt;GraphMol/RWMol.h&gt;</code><br />
<code>#include &lt;GraphMol/MolOps.h&gt;</code><br />
<code>#include &lt;GraphMol/inchi.h&gt;</code><br />
<code>#include &lt;Python.h&gt;</code><br />
<code>#include &lt;numpy/arrayobject.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_init_numpy_array_module.html">InitNumpyArrayModule</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mol_brief_data.html">MolBriefData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_normalization_options.html">NormalizationOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_types.html">Types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mol_key.html">MolKey</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab6e6ee86736f9ebb56e74ae21bf3ff8a" id="r_ab6e6ee86736f9ebb56e74ae21bf3ff8a"><td class="memItemLeft" align="right" valign="top"><a id="ab6e6ee86736f9ebb56e74ae21bf3ff8a" name="ab6e6ee86736f9ebb56e74ae21bf3ff8a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NPY_NO_DEPRECATED_API</b>&#160;&#160;&#160;NPY_1_7_API_VERSION</td></tr>
<tr class="separator:ab6e6ee86736f9ebb56e74ae21bf3ff8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a09beaa25d021039e8b690fe76de62024" id="r_a09beaa25d021039e8b690fe76de62024"><td class="memItemLeft" align="right" valign="top"><a id="a09beaa25d021039e8b690fe76de62024" name="a09beaa25d021039e8b690fe76de62024"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>FileType</b> = FILE*</td></tr>
<tr class="separator:a09beaa25d021039e8b690fe76de62024"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a27d9eab817696f157915b419b7b1c94b" id="r_a27d9eab817696f157915b419b7b1c94b"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a27d9eab817696f157915b419b7b1c94b">NormalizationMethod</a> { <a class="el" href="#a27d9eab817696f157915b419b7b1c94bab50339a10e1de285ac99d4c3990b8693">NONE</a>
, <a class="el" href="#a27d9eab817696f157915b419b7b1c94ba1e23852820b9154316c7c06e2b7ba051">NORMAL</a>
, <a class="el" href="#a27d9eab817696f157915b419b7b1c94baec8fc2c42b9c76effd648a14b311411f">UNIT</a>
 }</td></tr>
<tr class="separator:a27d9eab817696f157915b419b7b1c94b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa007dfeba975ca7af671e7e0e3359293" id="r_aa007dfeba975ca7af671e7e0e3359293"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; std::vector&lt; int64_t &gt;, std::vector&lt; int32_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa007dfeba975ca7af671e7e0e3359293">load_num_cols_and_dtypes</a> (const std::string &amp;processed_graph_data_path, const std::string &amp;data_hash)</td></tr>
<tr class="separator:aa007dfeba975ca7af671e7e0e3359293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff80abfc6b105a86a4d7b1a6f6f7f5ff" id="r_aff80abfc6b105a86a4d7b1a6f6f7f5ff"><td class="memTemplParams" colspan="2"><a id="aff80abfc6b105a86a4d7b1a6f6f7f5ff" name="aff80abfc6b105a86a4d7b1a6f6f7f5ff"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:aff80abfc6b105a86a4d7b1a6f6f7f5ff"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><b>save_array_to_file</b> (const std::filesystem::path &amp;directory, const char *const filename, const T *data, const uint64_t n)</td></tr>
<tr class="separator:aff80abfc6b105a86a4d7b1a6f6f7f5ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbe2c5abc16286d1eb15b3f194901eb9" id="r_afbe2c5abc16286d1eb15b3f194901eb9"><td class="memTemplParams" colspan="2"><a id="afbe2c5abc16286d1eb15b3f194901eb9" name="afbe2c5abc16286d1eb15b3f194901eb9"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:afbe2c5abc16286d1eb15b3f194901eb9"><td class="memTemplItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memTemplItemRight" valign="bottom"><b>load_array_from_file</b> (const std::filesystem::path &amp;directory, const char *const filename, std::unique_ptr&lt; T[]&gt; &amp;data)</td></tr>
<tr class="separator:afbe2c5abc16286d1eb15b3f194901eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a298404ec492a7f060db5b4258b8efed9" id="r_a298404ec492a7f060db5b4258b8efed9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; at::Tensor &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a298404ec492a7f060db5b4258b8efed9">load_metadata_tensors</a> (const std::string processed_graph_data_path, const std::string stage, const std::string data_hash)</td></tr>
<tr class="separator:a298404ec492a7f060db5b4258b8efed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8525fec82d8c05368d01ed8b33f6d37" id="r_ae8525fec82d8c05368d01ed8b33f6d37"><td class="memItemLeft" align="right" valign="top">std::vector&lt; at::Tensor &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8525fec82d8c05368d01ed8b33f6d37">load_stats</a> (const std::string processed_graph_data_path, const std::string data_hash, const std::string task_name)</td></tr>
<tr class="separator:ae8525fec82d8c05368d01ed8b33f6d37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc6b5879c417d80353a65dd4240ff4c" id="r_a3bc6b5879c417d80353a65dd4240ff4c"><td class="memItemLeft" align="right" valign="top">std::pair&lt; at::Tensor, at::Tensor &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3bc6b5879c417d80353a65dd4240ff4c">concatenate_strings</a> (pybind11::handle handle)</td></tr>
<tr class="separator:a3bc6b5879c417d80353a65dd4240ff4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb30af1b09de5bab5ff54caada33b8a2" id="r_adb30af1b09de5bab5ff54caada33b8a2"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; std::unordered_map&lt; std::string, std::vector&lt; at::Tensor &gt; &gt;, std::unordered_map&lt; std::string, std::vector&lt; at::Tensor &gt; &gt;, std::vector&lt; int64_t &gt;, std::vector&lt; int32_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adb30af1b09de5bab5ff54caada33b8a2">prepare_and_save_data</a> (const pybind11::list &amp;task_names, pybind11::dict &amp;task_dataset_args, const pybind11::dict &amp;task_label_normalization, const std::string processed_graph_data_path, const std::string data_hash, const pybind11::dict &amp;task_train_indices, const pybind11::dict &amp;task_val_indices, const pybind11::dict &amp;task_test_indices, bool add_self_loop, bool explicit_H, int max_threads, bool merge_equivalent_mols)</td></tr>
<tr class="separator:adb30af1b09de5bab5ff54caada33b8a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37edd861411263ed57db3163ecc9e0e9" id="r_a37edd861411263ed57db3163ecc9e0e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37edd861411263ed57db3163ecc9e0e9">load_labels_from_index</a> (const std::string stage_directory, const int64_t mol_index, const at::Tensor &amp;mol_file_data_offsets, const pybind11::list &amp;label_names, const pybind11::list &amp;label_num_cols, const pybind11::list &amp;label_data_types, pybind11::dict &amp;labels)</td></tr>
<tr class="separator:a37edd861411263ed57db3163ecc9e0e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7287a6527fd240c9cbf2fa7fd2e2c1ce" id="r_a7287a6527fd240c9cbf2fa7fd2e2c1ce"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7287a6527fd240c9cbf2fa7fd2e2c1ce">extract_string</a> (const at::Tensor &amp;concat_strings, const at::Tensor &amp;string_offsets, const int64_t index)</td></tr>
<tr class="separator:a7287a6527fd240c9cbf2fa7fd2e2c1ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3fe550e7bd55d5b6bb30e8b27affeb4a" id="r_a3fe550e7bd55d5b6bb30e8b27affeb4a"><td class="memItemLeft" align="right" valign="top"><a id="a3fe550e7bd55d5b6bb30e8b27affeb4a" name="a3fe550e7bd55d5b6bb30e8b27affeb4a"></a>
const auto&#160;</td><td class="memItemRight" valign="bottom"><b>INVALID_FILE</b> = (FILE*)nullptr</td></tr>
<tr class="separator:a3fe550e7bd55d5b6bb30e8b27affeb4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76fd3c41fa982bb1ab70141e3a1f4be6" id="r_a76fd3c41fa982bb1ab70141e3a1f4be6"><td class="memItemLeft" align="right" valign="top">constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76fd3c41fa982bb1ab70141e3a1f4be6">num_mols_per_file</a> = 1024</td></tr>
<tr class="separator:a76fd3c41fa982bb1ab70141e3a1f4be6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ffcc5cb2e0b56aedc9c9f274c53ab9e" id="r_a4ffcc5cb2e0b56aedc9c9f274c53ab9e"><td class="memItemLeft" align="right" valign="top"><a id="a4ffcc5cb2e0b56aedc9c9f274c53ab9e" name="a4ffcc5cb2e0b56aedc9c9f274c53ab9e"></a>
constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>num_supported_types</b> = 3</td></tr>
<tr class="separator:a4ffcc5cb2e0b56aedc9c9f274c53ab9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39bdd8bc3d067dce72c9926e655b10d6" id="r_a39bdd8bc3d067dce72c9926e655b10d6"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="struct_types.html">Types</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a39bdd8bc3d067dce72c9926e655b10d6">supported_types</a> [num_supported_types]</td></tr>
<tr class="separator:a39bdd8bc3d067dce72c9926e655b10d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2e641d48d91c90c331af30d7dff1856" id="r_aa2e641d48d91c90c331af30d7dff1856"><td class="memItemLeft" align="right" valign="top"><a id="aa2e641d48d91c90c331af30d7dff1856" name="aa2e641d48d91c90c331af30d7dff1856"></a>
constexpr const char *const&#160;</td><td class="memItemRight" valign="bottom"><b>label_metadata_filename</b> = &quot;label_metadata.tmp&quot;</td></tr>
<tr class="separator:aa2e641d48d91c90c331af30d7dff1856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ff222dd3710239f862e7548601eb8f" id="r_aa8ff222dd3710239f862e7548601eb8f"><td class="memItemLeft" align="right" valign="top"><a id="aa8ff222dd3710239f862e7548601eb8f" name="aa8ff222dd3710239f862e7548601eb8f"></a>
constexpr const char *const&#160;</td><td class="memItemRight" valign="bottom"><b>file_data_offsets_filename</b> = &quot;file_data_offsets.tmp&quot;</td></tr>
<tr class="separator:aa8ff222dd3710239f862e7548601eb8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28708534e55977cc6031cb15c3db36f8" id="r_a28708534e55977cc6031cb15c3db36f8"><td class="memItemLeft" align="right" valign="top"><a id="a28708534e55977cc6031cb15c3db36f8" name="a28708534e55977cc6031cb15c3db36f8"></a>
constexpr const char *const&#160;</td><td class="memItemRight" valign="bottom"><b>concat_smiles_filename</b> = &quot;concat_smiles.tmp&quot;</td></tr>
<tr class="separator:a28708534e55977cc6031cb15c3db36f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e6e3c206f62688e61f0aa50c17be11" id="r_a97e6e3c206f62688e61f0aa50c17be11"><td class="memItemLeft" align="right" valign="top"><a id="a97e6e3c206f62688e61f0aa50c17be11" name="a97e6e3c206f62688e61f0aa50c17be11"></a>
constexpr const char *const&#160;</td><td class="memItemRight" valign="bottom"><b>smiles_offsets_filename</b> = &quot;smiles_offsets.tmp&quot;</td></tr>
<tr class="separator:a97e6e3c206f62688e61f0aa50c17be11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af152e28e3f40f98c8a2bc0626d777942" id="r_af152e28e3f40f98c8a2bc0626d777942"><td class="memItemLeft" align="right" valign="top"><a id="af152e28e3f40f98c8a2bc0626d777942" name="af152e28e3f40f98c8a2bc0626d777942"></a>
constexpr const char *const&#160;</td><td class="memItemRight" valign="bottom"><b>num_nodes_filename</b> = &quot;num_nodes.tmp&quot;</td></tr>
<tr class="separator:af152e28e3f40f98c8a2bc0626d777942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475d97a97ee64a299bb7b949bb966127" id="r_a475d97a97ee64a299bb7b949bb966127"><td class="memItemLeft" align="right" valign="top"><a id="a475d97a97ee64a299bb7b949bb966127" name="a475d97a97ee64a299bb7b949bb966127"></a>
constexpr const char *const&#160;</td><td class="memItemRight" valign="bottom"><b>num_edges_filename</b> = &quot;num_edges.tmp&quot;</td></tr>
<tr class="separator:a475d97a97ee64a299bb7b949bb966127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a9873ea5621fb2ec09c122243653cea" id="r_a5a9873ea5621fb2ec09c122243653cea"><td class="memItemLeft" align="right" valign="top"><a id="a5a9873ea5621fb2ec09c122243653cea" name="a5a9873ea5621fb2ec09c122243653cea"></a>
constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>num_stages</b> = 3</td></tr>
<tr class="separator:a5a9873ea5621fb2ec09c122243653cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53043053627763eaaf29f07bfd0ad06" id="r_ac53043053627763eaaf29f07bfd0ad06"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac53043053627763eaaf29f07bfd0ad06">stages</a> [num_stages]</td></tr>
<tr class="separator:ac53043053627763eaaf29f07bfd0ad06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a929a2c37b9a798f2d9510df27ad47096" id="r_a929a2c37b9a798f2d9510df27ad47096"><td class="memItemLeft" align="right" valign="top"><a id="a929a2c37b9a798f2d9510df27ad47096" name="a929a2c37b9a798f2d9510df27ad47096"></a>
constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>stat_min_offset</b> = 0</td></tr>
<tr class="separator:a929a2c37b9a798f2d9510df27ad47096"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca9f6f5f16c3193289a70dbc2e06ba4" id="r_acca9f6f5f16c3193289a70dbc2e06ba4"><td class="memItemLeft" align="right" valign="top"><a id="acca9f6f5f16c3193289a70dbc2e06ba4" name="acca9f6f5f16c3193289a70dbc2e06ba4"></a>
constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>stat_max_offset</b> = 1</td></tr>
<tr class="separator:acca9f6f5f16c3193289a70dbc2e06ba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad020a30c8d418f163fc48c1871f4b4ac" id="r_ad020a30c8d418f163fc48c1871f4b4ac"><td class="memItemLeft" align="right" valign="top"><a id="ad020a30c8d418f163fc48c1871f4b4ac" name="ad020a30c8d418f163fc48c1871f4b4ac"></a>
constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>stat_mean_offset</b> = 2</td></tr>
<tr class="separator:ad020a30c8d418f163fc48c1871f4b4ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d61dc9c22a653573113eced3e05abbd" id="r_a9d61dc9c22a653573113eced3e05abbd"><td class="memItemLeft" align="right" valign="top"><a id="a9d61dc9c22a653573113eced3e05abbd" name="a9d61dc9c22a653573113eced3e05abbd"></a>
constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>stat_std_offset</b> = 3</td></tr>
<tr class="separator:a9d61dc9c22a653573113eced3e05abbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad11f1d4a23d3ccb32f8bef15c83fc272" id="r_ad11f1d4a23d3ccb32f8bef15c83fc272"><td class="memItemLeft" align="right" valign="top"><a id="ad11f1d4a23d3ccb32f8bef15c83fc272" name="ad11f1d4a23d3ccb32f8bef15c83fc272"></a>
constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>num_stats</b> = 4</td></tr>
<tr class="separator:ad11f1d4a23d3ccb32f8bef15c83fc272"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a27d9eab817696f157915b419b7b1c94b" name="a27d9eab817696f157915b419b7b1c94b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27d9eab817696f157915b419b7b1c94b">&#9670;&#160;</a></span>NormalizationMethod</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="#a27d9eab817696f157915b419b7b1c94b">NormalizationMethod</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Normalization methods for use in <code>prepare_and_save_data</code>. Not to be confused with the normalization of the graph Laplacian matrix in positional features. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a27d9eab817696f157915b419b7b1c94bab50339a10e1de285ac99d4c3990b8693" name="a27d9eab817696f157915b419b7b1c94bab50339a10e1de285ac99d4c3990b8693"></a>NONE&#160;</td><td class="fielddoc"><p>No normalization. </p>
</td></tr>
<tr><td class="fieldname"><a id="a27d9eab817696f157915b419b7b1c94ba1e23852820b9154316c7c06e2b7ba051" name="a27d9eab817696f157915b419b7b1c94ba1e23852820b9154316c7c06e2b7ba051"></a>NORMAL&#160;</td><td class="fielddoc"><p>Subtract mean and divide by standard deviation. </p>
</td></tr>
<tr><td class="fieldname"><a id="a27d9eab817696f157915b419b7b1c94baec8fc2c42b9c76effd648a14b311411f" name="a27d9eab817696f157915b419b7b1c94baec8fc2c42b9c76effd648a14b311411f"></a>UNIT&#160;</td><td class="fielddoc"><p>Subtract minimum and divide by range. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3bc6b5879c417d80353a65dd4240ff4c" name="a3bc6b5879c417d80353a65dd4240ff4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bc6b5879c417d80353a65dd4240ff4c">&#9670;&#160;</a></span>concatenate_strings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; at::Tensor, at::Tensor &gt; concatenate_strings </td>
          <td>(</td>
          <td class="paramtype">pybind11::handle</td>          <td class="paramname"><span class="paramname"><em>handle</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Accepts a Numpy array of strings or Python list of strings, and returns a PyTorch tensor of all of the characters and another tensor containing indices into the other tensor indicating where each string begins, plus one extra index indicating the end.</p>
<p>This is implemented in <a class="el" href="labels_8cpp.html">labels.cpp</a>, and declared here so that <a class="el" href="graphium__cpp_8cpp.html">graphium_cpp.cpp</a> can expose it to Python via pybind. </p>

</div>
</div>
<a id="a7287a6527fd240c9cbf2fa7fd2e2c1ce" name="a7287a6527fd240c9cbf2fa7fd2e2c1ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7287a6527fd240c9cbf2fa7fd2e2c1ce">&#9670;&#160;</a></span>extract_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string extract_string </td>
          <td>(</td>
          <td class="paramtype">const at::Tensor &amp;</td>          <td class="paramname"><span class="paramname"><em>concat_strings</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const at::Tensor &amp;</td>          <td class="paramname"><span class="paramname"><em>string_offsets</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t</td>          <td class="paramname"><span class="paramname"><em>index</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extracts a single string from <code>concat_strings</code>, a Tensor of contatenated strings, using offsets at the specified <code>index</code> in <code>string_offsets</code>.</p>
<p>The tensors can be returned by <code>load_metadata_tensors</code>, <code>concatenate_strings</code>, or <code>prepare_and_save_data</code>.</p>
<p>This is implemented in <a class="el" href="labels_8cpp.html">labels.cpp</a>, and declared here so that <a class="el" href="graphium__cpp_8cpp.html">graphium_cpp.cpp</a> can expose it to Python via pybind. </p>

</div>
</div>
<a id="a37edd861411263ed57db3163ecc9e0e9" name="a37edd861411263ed57db3163ecc9e0e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37edd861411263ed57db3163ecc9e0e9">&#9670;&#160;</a></span>load_labels_from_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_labels_from_index </td>
          <td>(</td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>stage_directory</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t</td>          <td class="paramname"><span class="paramname"><em>mol_index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const at::Tensor &amp;</td>          <td class="paramname"><span class="paramname"><em>mol_file_data_offsets</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pybind11::list &amp;</td>          <td class="paramname"><span class="paramname"><em>label_names</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pybind11::list &amp;</td>          <td class="paramname"><span class="paramname"><em>label_num_cols</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pybind11::list &amp;</td>          <td class="paramname"><span class="paramname"><em>label_data_types</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pybind11::dict &amp;</td>          <td class="paramname"><span class="paramname"><em>labels</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads label data associated with the molecule with index <code>mol_index</code> from the corresponding file in the directory <code>stage_directory</code>, and adds the data to <code>labels</code> dictionary using the strings from <code>label_names</code> to map to tensors. The label data must be previously saved by <code>prepare_and_save_data</code>. <code>mol_file_data_offsets</code> is used to determine how to find the data in the file, <code>label_data_types</code> is used for the type and size of each float, and <code>label_num_cols</code> is used to determine the layout of each output tensor, especially ones with multiple rows, such as node-level, edge-level, or node-pair-level label data.</p>
<p>This is implemented in <a class="el" href="labels_8cpp.html">labels.cpp</a>, and declared here so that <a class="el" href="graphium__cpp_8cpp.html">graphium_cpp.cpp</a> can expose it to Python via pybind. </p>

</div>
</div>
<a id="a298404ec492a7f060db5b4258b8efed9" name="a298404ec492a7f060db5b4258b8efed9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a298404ec492a7f060db5b4258b8efed9">&#9670;&#160;</a></span>load_metadata_tensors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; at::Tensor &gt; load_metadata_tensors </td>
          <td>(</td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>processed_graph_data_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>stage</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>data_hash</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the stage-specific label metadata files that were already saved by <code>prepare_and_save_data</code>, possibly on a previous run, in the directory <code>processed_graph_data_path/stage_data_hash</code>. Returns an empty list on failure.</p>
<p>On success, the returned tensors are: 0) All SMILES strings concatenated, 1) The beginning offsets of each SMILES string in the first tensor, and one extra at the end equal to the length of the first tensor 2) The number of nodes (atoms) in each molecule 3) The number of edges (bonds) in each molecule 4) (Optional if only inference) The offset of each molecule's label data within the label data files, plus an extra for the end of each file The first two tensors are used by <code>extract_string</code>. The optional last tensor is used by <code>load_labels_from_index</code>.</p>
<p>This is implemented in <a class="el" href="labels_8cpp.html">labels.cpp</a>, and declared here so that <a class="el" href="graphium__cpp_8cpp.html">graphium_cpp.cpp</a> can expose it to Python via pybind. </p>

</div>
</div>
<a id="aa007dfeba975ca7af671e7e0e3359293" name="aa007dfeba975ca7af671e7e0e3359293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa007dfeba975ca7af671e7e0e3359293">&#9670;&#160;</a></span>load_num_cols_and_dtypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; std::vector&lt; int64_t &gt;, std::vector&lt; int32_t &gt; &gt; load_num_cols_and_dtypes </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>processed_graph_data_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>data_hash</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads the number of columns and data type for each task, from the common label metadata file that was already saved by <code>prepare_and_save_data</code>, possibly on a previous run, in the directory <code>processed_graph_data_path/data_hash</code>. Returns empty lists on failure.</p>
<p>This is implemented in <a class="el" href="labels_8cpp.html">labels.cpp</a>, and declared here so that <a class="el" href="graphium__cpp_8cpp.html">graphium_cpp.cpp</a> can expose it to Python via pybind. </p>

</div>
</div>
<a id="ae8525fec82d8c05368d01ed8b33f6d37" name="ae8525fec82d8c05368d01ed8b33f6d37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8525fec82d8c05368d01ed8b33f6d37">&#9670;&#160;</a></span>load_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; at::Tensor &gt; load_stats </td>
          <td>(</td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>processed_graph_data_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>data_hash</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>task_name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads data from the task-specific stats file that was already saved by <code>prepare_and_save_data</code>, possibly on a previous run, in the directory <code>processed_graph_data_path/data_hash</code>. Returns an empty list on failure.</p>
<p>Each tensor's length is the number of columns for this task, and there are 4 tensors total: minimum, maximum, mean, standard deviation.</p>
<p>This is implemented in <a class="el" href="labels_8cpp.html">labels.cpp</a>, and declared here so that <a class="el" href="graphium__cpp_8cpp.html">graphium_cpp.cpp</a> can expose it to Python via pybind. </p>

</div>
</div>
<a id="adb30af1b09de5bab5ff54caada33b8a2" name="adb30af1b09de5bab5ff54caada33b8a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb30af1b09de5bab5ff54caada33b8a2">&#9670;&#160;</a></span>prepare_and_save_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; std::unordered_map&lt; std::string, std::vector&lt; at::Tensor &gt; &gt;, std::unordered_map&lt; std::string, std::vector&lt; at::Tensor &gt; &gt;, std::vector&lt; int64_t &gt;, std::vector&lt; int32_t &gt; &gt; prepare_and_save_data </td>
          <td>(</td>
          <td class="paramtype">const pybind11::list &amp;</td>          <td class="paramname"><span class="paramname"><em>task_names</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pybind11::dict &amp;</td>          <td class="paramname"><span class="paramname"><em>task_dataset_args</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pybind11::dict &amp;</td>          <td class="paramname"><span class="paramname"><em>task_label_normalization</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>processed_graph_data_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string</td>          <td class="paramname"><span class="paramname"><em>data_hash</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pybind11::dict &amp;</td>          <td class="paramname"><span class="paramname"><em>task_train_indices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pybind11::dict &amp;</td>          <td class="paramname"><span class="paramname"><em>task_val_indices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pybind11::dict &amp;</td>          <td class="paramname"><span class="paramname"><em>task_test_indices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>add_self_loop</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>explicit_H</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>max_threads</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>merge_equivalent_mols</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Merges label data for equivalent molecules from separate datasets, computes statistics, and caches the label data to files for efficient loading later.</p>
<p>This is implemented in <a class="el" href="labels_8cpp.html">labels.cpp</a>, and declared here so that <a class="el" href="graphium__cpp_8cpp.html">graphium_cpp.cpp</a> can expose it to Python via pybind.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">task_names</td><td>Python list of the names of the datasets to process. These are used for looking up into the other parameters starting with <code>task_</code>, and the beginning of each name must be <code>graph_</code>, <code>node_</code>, <code>edge_</code>, or <code>nodepair_</code> to determine the level of the label data. </td></tr>
    <tr><td class="paramname">task_dataset_args</td><td>Python dict mapping task names to Python dicts for each dataset. Each task's dict must contain a mapping from <code>"smiles"</code> to a 1D Numpy array of objects, each of which is a Python string with a molecule's SMILES text. If doing inference, each task's dict must also map from <code>"labels"</code> to a 2D Numpy array of float16, float32, or float64 type. For node, edge, or node-pair level label data, the dict must also map from <code>"label_offsets"</code> to a 1D Numpy array of type int64, indicating the row in the <code>"labels"</code> array where each molecule's data begins, plus an extra for the end. If <code>"label_offsets"</code> is not present, the <code>"labels"</code> array has one row per molecule, and if it is present, the <code>"labels"</code> array has one row per atom, bond, or pair of atoms, according to the label level. </td></tr>
    <tr><td class="paramname">task_label_normalization</td><td>Python dict mapping task names to Python dicts for each dataset's normalization options. Each task's dict must contain a mapping from <code>"method"</code> to either <code>"none"</code>, <code>"normal"</code>, or <code>"unit"</code>, and can optionally contain a mapping from <code>"min_clipping"</code> and/or <code>"max_clipping"</code> to a Python float or int to explicitly clip the range. </td></tr>
    <tr><td class="paramname">processed_graph_data_path</td><td>String containing the base directory to create subdirectories for cached files in. It can exist already, or will be created if it does not already exist. </td></tr>
    <tr><td class="paramname">data_hash</td><td>String representing a hash of the label data options. It will be used in the names of all subdirectories created under <code>processed_graph_data_path</code>. </td></tr>
    <tr><td class="paramname">task_train_indices</td><td>Python dict mapping task names to Python lists of ints, indicating indices into <code>task_dataset_args[task_name]["smiles"]</code> and other per-molecule-per-task arrays. Only these molecules will be used for the "train" stage. </td></tr>
    <tr><td class="paramname">task_val_indices</td><td>Python dict mapping task names to Python lists of ints, indicating indices into <code>task_dataset_args[task_name]["smiles"]</code> and other per-molecule-per-task arrays. Only these molecules will be used for the "val" stage. </td></tr>
    <tr><td class="paramname">task_test_indices</td><td>Python dict mapping task names to Python lists of ints, indicating indices into <code>task_dataset_args[task_name]["smiles"]</code> and other per-molecule-per-task arrays. Only these molecules will be used for the "test" stage. </td></tr>
    <tr><td class="paramname">add_self_loop</td><td>If true (default is false), <code>num_atoms</code> is added to the number of directed edges (twice the number of bonds). This is for consistency with <code>featurize_smiles</code> later. </td></tr>
    <tr><td class="paramname">explicit_H</td><td>If true (default is false), any implicit hydrogens will be made explicit, possibly increasing the number of atoms. </td></tr>
    <tr><td class="paramname">max_threads</td><td>If greater than zero, at most this many threads will be created for processing in parallel. If zero (the default), at most one thread per logical CPU core will be created. If less than zero, the limit is reduced by adding this negative amount to the number of logical CPU cores. </td></tr>
    <tr><td class="paramname">merge_equivalent_mols</td><td>If true (the default), label data for the same molecule in different datasets are collected together, even if the atoms or bonds are in a different order. Duplicates of the same molecule within a single dataset will be ignored. This is very slow, and changes the number and order of the molecules, so it can be set to false for inference, where there is no label data or only one dataset. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Four objects:<ul>
<li>A dict mapping the stage names ("train", "val", "test") to a list of five 1D PyTorch tensors: 0) SMILES strings all concatenated, one per unique molecule 1) Offsets into the previous tensor where the strings begin, one per unique molecule, plus one extra for the end 2) Number of nodes (atoms) in each unique molecule 3) Number of edges (2*bonds) in each unique molecule 4) (Only if there is label data) <code>mol_file_data_offsets</code> to be passed to calls to <code>load_labels_from_index</code></li>
<li>A dict mapping task names to a list of four 1D PyTorch tensors for column normalization: minimum, maximum, mean, standard deviation</li>
<li>A list of the number of columns in each task, in the same order as <code>task_names</code></li>
<li>A list of integers representing the Torch data type of each task, in the same order as <code>task_names</code> </li>
</ul>
</dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a76fd3c41fa982bb1ab70141e3a1f4be6" name="a76fd3c41fa982bb1ab70141e3a1f4be6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76fd3c41fa982bb1ab70141e3a1f4be6">&#9670;&#160;</a></span>num_mols_per_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t num_mols_per_file = 1024</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To avoid having one gigantic label data file or millions of tiny label data files, store label data for 1024 molecules in each file. </p>

</div>
</div>
<a id="ac53043053627763eaaf29f07bfd0ad06" name="ac53043053627763eaaf29f07bfd0ad06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac53043053627763eaaf29f07bfd0ad06">&#9670;&#160;</a></span>stages</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string stages[num_stages]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    std::string(<span class="stringliteral">&quot;train&quot;</span>),</div>
<div class="line">    std::string(<span class="stringliteral">&quot;val&quot;</span>),</div>
<div class="line">    std::string(<span class="stringliteral">&quot;test&quot;</span>)</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a39bdd8bc3d067dce72c9926e655b10d6" name="a39bdd8bc3d067dce72c9926e655b10d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39bdd8bc3d067dce72c9926e655b10d6">&#9670;&#160;</a></span>supported_types</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_types.html">Types</a> supported_types[num_supported_types]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    {2, NPY_FLOAT16, c10::ScalarType::Half},</div>
<div class="line">    {4, NPY_FLOAT32, c10::ScalarType::Float},</div>
<div class="line">    {8, NPY_FLOAT64, c10::ScalarType::Double}</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
