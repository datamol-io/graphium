
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Graphium: Scaling molecular GNNs to infinity.">
      
      
      
        <link rel="canonical" href="https://github.com/datamol-io/graphium/main/api/graphium.nn/architectures.html">
      
      
        <link rel="prev" href="graphium.nn.html">
      
      
        <link rel="next" href="encoders.html">
      
      
      <link rel="icon" href="../../images/logo-mini-dark.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>graphium.nn.architectures - graphium</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../_assets/css/custom.css">
    
      <link rel="stylesheet" href="../../_assets/css/custom-graphium.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#graphiumnnarchitectures" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="graphium" class="md-header__button md-logo" aria-label="graphium" data-md-component="logo">
      
  <img src="../../images/logo-mini-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            graphium
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              graphium.nn.architectures
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/datamol-io/graphium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    valence-discovery/graphium
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../baseline.html" class="md-tabs__link">
        
  
    
  
  Baseline

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="graphium.nn.html" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/feature_processing/add_new_positional_encoding.html" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../design.html" class="md-tabs__link">
        
  
    
  
  Design

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../datasets.html" class="md-tabs__link">
        
  
    
  
  Datasets

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pretrained_models.html" class="md-tabs__link">
        
  
    
  
  Pretrained Models

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cli/reference.html" class="md-tabs__link">
          
  
  CLI

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../contribute.html" class="md-tabs__link">
        
  
    
  
  Contribute

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../license.html" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="graphium" class="md-nav__button md-logo" aria-label="graphium" data-md-component="logo">
      
  <img src="../../images/logo-mini-white.svg" alt="logo">

    </a>
    graphium
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/datamol-io/graphium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    valence-discovery/graphium
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../baseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Baseline
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    graphium.nn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            graphium.nn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    graphium.nn.architectures
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="architectures.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    graphium.nn.architectures
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#global-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      Global Architectures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Global Architectures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures" class="md-nav__link">
    <span class="md-ellipsis">
      global_architectures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="global_architectures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN" class="md-nav__link">
    <span class="md-ellipsis">
      EnsembleFeedForwardNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EnsembleFeedForwardNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.get_init_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      get_init_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph" class="md-nav__link">
    <span class="md-ellipsis">
      FeedForwardGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeedForwardGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.get_init_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      get_init_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.get_nested_key" class="md-nav__link">
    <span class="md-ellipsis">
      get_nested_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN" class="md-nav__link">
    <span class="md-ellipsis">
      FeedForwardNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeedForwardNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.cache_readouts" class="md-nav__link">
    <span class="md-ellipsis">
      cache_readouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.add_layers" class="md-nav__link">
    <span class="md-ellipsis">
      add_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.drop_layers" class="md-nav__link">
    <span class="md-ellipsis">
      drop_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.get_init_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      get_init_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      FullGraphMultiTaskNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FullGraphMultiTaskNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.in_dim" class="md-nav__link">
    <span class="md-ellipsis">
      in_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.in_dim_edges" class="md-nav__link">
    <span class="md-ellipsis">
      in_dim_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.out_dim" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.out_dim_edges" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.create_module_map" class="md-nav__link">
    <span class="md-ellipsis">
      create_module_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.set_max_num_nodes_edges_per_graph" class="md-nav__link">
    <span class="md-ellipsis">
      set_max_num_nodes_edges_per_graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN" class="md-nav__link">
    <span class="md-ellipsis">
      GraphOutputNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GraphOutputNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.concat_last_layers" class="md-nav__link">
    <span class="md-ellipsis">
      concat_last_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.out_dim" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.compute_nodepairs" class="md-nav__link">
    <span class="md-ellipsis">
      compute_nodepairs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.drop_graph_output_nn_layers" class="md-nav__link">
    <span class="md-ellipsis">
      drop_graph_output_nn_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.extend_graph_output_nn_layers" class="md-nav__link">
    <span class="md-ellipsis">
      extend_graph_output_nn_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.set_max_num_nodes_edges_per_graph" class="md-nav__link">
    <span class="md-ellipsis">
      set_max_num_nodes_edges_per_graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads" class="md-nav__link">
    <span class="md-ellipsis">
      TaskHeads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TaskHeads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.out_dim" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.set_max_num_nodes_edges_per_graph" class="md-nav__link">
    <span class="md-ellipsis">
      set_max_num_nodes_edges_per_graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyg-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      PyG Architectures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyG Architectures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.pyg_architectures" class="md-nav__link">
    <span class="md-ellipsis">
      pyg_architectures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pyg_architectures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.pyg_architectures.FeedForwardPyg" class="md-nav__link">
    <span class="md-ellipsis">
      FeedForwardPyg
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encoder-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Encoder Manager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encoder Manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager" class="md-nav__link">
    <span class="md-ellipsis">
      encoder_manager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="encoder_manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager" class="md-nav__link">
    <span class="md-ellipsis">
      EncoderManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EncoderManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.in_dims" class="md-nav__link">
    <span class="md-ellipsis">
      in_dims
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.input_keys" class="md-nav__link">
    <span class="md-ellipsis">
      input_keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.out_dim" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward_positional_encoding" class="md-nav__link">
    <span class="md-ellipsis">
      forward_positional_encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward_simple_pooling" class="md-nav__link">
    <span class="md-ellipsis">
      forward_simple_pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="encoders.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn.encoders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pyg_layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn.pyg_layers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.trainer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.ipu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.ipu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.finetuning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.finetuning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    feature_processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            feature_processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/feature_processing/add_new_positional_encoding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add new positional encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/feature_processing/csv_to_parquet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert CSV to Parquet files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/feature_processing/timing_parallel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timing parallel processing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    gnn_layers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            gnn_layers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gnn/add_new_gnn_layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating GNN layers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gnn/making_gnn_networks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Making GNN Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gnn/using_gnn_layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using GNN layers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    model_training
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            model_training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/model_training/simple-molecular-model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building and training a simple model from configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/model_training/running-multitask-ipu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multitask Molecular Modelling with Graphium on the IPU
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pretrained_models.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pretrained Models
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CLI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            CLI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/reference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/graphium.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/graphium-train.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium-train
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contribute.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#global-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      Global Architectures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Global Architectures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures" class="md-nav__link">
    <span class="md-ellipsis">
      global_architectures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="global_architectures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN" class="md-nav__link">
    <span class="md-ellipsis">
      EnsembleFeedForwardNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EnsembleFeedForwardNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.get_init_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      get_init_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph" class="md-nav__link">
    <span class="md-ellipsis">
      FeedForwardGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeedForwardGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.get_init_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      get_init_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.get_nested_key" class="md-nav__link">
    <span class="md-ellipsis">
      get_nested_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN" class="md-nav__link">
    <span class="md-ellipsis">
      FeedForwardNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeedForwardNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.cache_readouts" class="md-nav__link">
    <span class="md-ellipsis">
      cache_readouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.add_layers" class="md-nav__link">
    <span class="md-ellipsis">
      add_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.drop_layers" class="md-nav__link">
    <span class="md-ellipsis">
      drop_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.get_init_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      get_init_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      FullGraphMultiTaskNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FullGraphMultiTaskNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.in_dim" class="md-nav__link">
    <span class="md-ellipsis">
      in_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.in_dim_edges" class="md-nav__link">
    <span class="md-ellipsis">
      in_dim_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.out_dim" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.out_dim_edges" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.create_module_map" class="md-nav__link">
    <span class="md-ellipsis">
      create_module_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.set_max_num_nodes_edges_per_graph" class="md-nav__link">
    <span class="md-ellipsis">
      set_max_num_nodes_edges_per_graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN" class="md-nav__link">
    <span class="md-ellipsis">
      GraphOutputNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GraphOutputNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.concat_last_layers" class="md-nav__link">
    <span class="md-ellipsis">
      concat_last_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.out_dim" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.compute_nodepairs" class="md-nav__link">
    <span class="md-ellipsis">
      compute_nodepairs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.drop_graph_output_nn_layers" class="md-nav__link">
    <span class="md-ellipsis">
      drop_graph_output_nn_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.extend_graph_output_nn_layers" class="md-nav__link">
    <span class="md-ellipsis">
      extend_graph_output_nn_layers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.set_max_num_nodes_edges_per_graph" class="md-nav__link">
    <span class="md-ellipsis">
      set_max_num_nodes_edges_per_graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads" class="md-nav__link">
    <span class="md-ellipsis">
      TaskHeads
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TaskHeads">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.out_dim" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.global_architectures.TaskHeads.set_max_num_nodes_edges_per_graph" class="md-nav__link">
    <span class="md-ellipsis">
      set_max_num_nodes_edges_per_graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyg-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      PyG Architectures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyG Architectures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.pyg_architectures" class="md-nav__link">
    <span class="md-ellipsis">
      pyg_architectures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pyg_architectures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.pyg_architectures.FeedForwardPyg" class="md-nav__link">
    <span class="md-ellipsis">
      FeedForwardPyg
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encoder-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Encoder Manager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encoder Manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager" class="md-nav__link">
    <span class="md-ellipsis">
      encoder_manager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="encoder_manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager" class="md-nav__link">
    <span class="md-ellipsis">
      EncoderManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EncoderManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.in_dims" class="md-nav__link">
    <span class="md-ellipsis">
      in_dims
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.input_keys" class="md-nav__link">
    <span class="md-ellipsis">
      input_keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.out_dim" class="md-nav__link">
    <span class="md-ellipsis">
      out_dim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward_positional_encoding" class="md-nav__link">
    <span class="md-ellipsis">
      forward_positional_encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward_simple_pooling" class="md-nav__link">
    <span class="md-ellipsis">
      forward_simple_pooling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.architectures.encoder_manager.EncoderManager.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="graphiumnnarchitectures">graphium.nn.architectures<a class="headerlink" href="#graphiumnnarchitectures" title="Permanent link">&para;</a></h1>
<p>High level architectures in the library</p>
<div class="tabbed-set" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Contents</label><div class="tabbed-content">
<ul>
<li><a href="#global-architectures">Global Architectures</a></li>
<li><a href="#pyg-architectures">PyG Architectures</a></li>
<li><a href="#encoder-manager">Encoder Manager</a></li>
</ul>
</div>
</div>
<h2 id="global-architectures">Global Architectures<a class="headerlink" href="#global-architectures" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">



<h3 id="graphium.nn.architectures.global_architectures" class="doc doc-heading">
          <code>graphium.nn.architectures.global_architectures</code>


<a href="#graphium.nn.architectures.global_architectures" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">
  
      <hr />
<p>Copyright (c) 2023 Valence Labs, Recursion Pharmaceuticals and Graphcore Limited.</p>
<p>Use of this software is subject to the terms and conditions outlined in the LICENSE file.
Unauthorized modification, distribution, or use is prohibited. Provided 'as is' without
warranties of any kind.</p>
<p>Valence Labs, Recursion Pharmaceuticals and Graphcore Limited are not liable for any damages arising from its use.
Refer to the LICENSE file for the full terms and conditions.</p>
<hr />

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN" class="doc doc-heading">
          <code>EnsembleFeedForwardNN</code>


<a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.nn.architectures.global_architectures.FeedForwardNN" href="#graphium.nn.architectures.global_architectures.FeedForwardNN">FeedForwardNN</a></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">hidden_dims</span><span class="p">,</span> <span class="n">num_ensemble</span><span class="p">,</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">subset_in_dim</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">last_activation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">last_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">first_normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">last_normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">residual_type</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">residual_skip_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LNN&#39;</span><span class="p">,</span> <span class="n">layer_type</span><span class="o">=</span><span class="s1">&#39;ens-fc&#39;</span><span class="p">,</span> <span class="n">layer_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">last_layer_is_readout</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>An ensemble of flexible neural network architecture, with variable hidden dimensions,
support for multiple layer types, and support for different residual
connections.</p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the layer

out_dim:
    Output feature dimensions of the layer

hidden_dims:
    Either an integer specifying all the hidden dimensions,
    or a list of dimensions in the hidden layers.
    Be careful, the "simple" residual type only supports
    hidden dimensions of the same value.

num_ensemble:
    Number of MLPs that run in parallel.

reduction:
    Reduction to use at the end of the MLP. Choices:

    - "none" or `None`: No reduction
    - "mean": Mean reduction
    - "sum": Sum reduction
    - "max": Max reduction
    - "min": Min reduction
    - "median": Median reduction
    - `Callable`: Any callable function. Must take `dim` as a keyword argument.

subset_in_dim:
    If float, ratio of the subset of the ensemble to use. Must be between 0 and 1.
    If int, number of elements to subset from in_dim.
    If `None`, the subset_in_dim is set to `1.0`.
    A different subset is used for each ensemble.
    Only valid if the input shape is `[B, Din]`.

depth:
    If `hidden_dims` is an integer, `depth` is 1 + the number of
    hidden layers to use.
    If `hidden_dims` is a list, then
    `depth` must be `None` or equal to `len(hidden_dims) + 1`

activation:
    activation function to use in the hidden layers.

last_activation:
    activation function to use in the last layer.

dropout:
    The ratio of units to dropout. Must be between 0 and 1

last_dropout:
    The ratio of units to dropout for the last_layer. Must be between 0 and 1

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

first_normalization:
    Whether to use batch normalization **before** the first layer

last_normalization:
    Whether to use batch normalization in the last layer

residual_type:
    - "none": No residual connection
    - "simple": Residual connection similar to the ResNet architecture.
      See class `ResidualConnectionSimple`
    - "weighted": Residual connection similar to the Resnet architecture,
      but with weights applied before the summation. See class `ResidualConnectionWeighted`
    - "concat": Residual connection where the residual is concatenated instead
      of being added.
    - "densenet": Residual connection where the residual of all previous layers
      are concatenated. This leads to a strong increase in the number of parameters
      if there are multiple hidden layers.

residual_skip_steps:
    The number of steps to skip between each residual connection.
    If `1`, all the layers are connected. If `2`, half of the
    layers are connected.

name:
    Name attributed to the current network, for display and printing
    purposes.

layer_type:
    The type of layers to use in the network.
    Either "ens-fc" as the `EnsembleFCLayer`, or a class representing the `nn.Module`
    to use.

layer_kwargs:
    The arguments to be used in the initialization of the layer provided by `layer_type`

last_layer_is_readout: Whether the last layer should be treated as a readout layer.
    Allows to use the `mup.MuReadout` from the muTransfer method https://github.com/microsoft/mup
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Controls how the class is printed</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Subset the hidden dimension for each MLP,
forward the ensemble MLP on the input features,
then reduce the output if specified.</p>
<p>Parameters:</p>
<pre><code>h: `torch.Tensor[B, Din]` or `torch.Tensor[..., 1, B, Din]` or `torch.Tensor[..., L, B, Din]`:

    Input feature tensor, before the MLP.
    `Din` is the number of input features, `B` is the batch size, and `L` is the number of ensembles.
</code></pre>
<p>Returns:</p>
<pre><code>`torch.Tensor[..., L, B, Dout]` or `torch.Tensor[..., B, Dout]`:

    Output feature tensor, after the MLP.
    `Dout` is the number of output features, `B` is the batch size, and `L` is the number of ensembles.
    `L` is removed if a reduction is specified.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.get_init_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_init_kwargs</span><span class="p">()</span></code>

<a href="#graphium.nn.architectures.global_architectures.EnsembleFeedForwardNN.get_init_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get a dictionary that can be used to instanciate a new object with identical parameters.</p>

  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.nn.architectures.global_architectures.FeedForwardGraph" class="doc doc-heading">
          <code>FeedForwardGraph</code>


<a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.nn.architectures.global_architectures.FeedForwardNN" href="#graphium.nn.architectures.global_architectures.FeedForwardNN">FeedForwardNN</a></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardGraph.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">hidden_dims</span><span class="p">,</span> <span class="n">layer_type</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">last_activation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">last_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">first_normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">last_normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">residual_type</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">residual_skip_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_dims_edges</span><span class="o">=</span><span class="p">[],</span> <span class="n">out_dim_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;GNN&#39;</span><span class="p">,</span> <span class="n">layer_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">virtual_node</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">use_virtual_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">last_layer_is_readout</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>A flexible neural network architecture, with variable hidden dimensions,
support for multiple layer types, and support for different residual
connections.</p>
<p>This class is meant to work with different graph neural networks
layers. Any layer must inherit from <code>graphium.nn.base_graph_layer.BaseGraphStructure</code>
or <code>graphium.nn.base_graph_layer.BaseGraphLayer</code>.</p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the layer

out_dim:
    Output feature dimensions of the layer

hidden_dims:
    List of dimensions in the hidden layers.
    Be careful, the "simple" residual type only supports
    hidden dimensions of the same value.

layer_type:
    Type of layer to use. Can be a string or nn.Module.

depth:
    If `hidden_dims` is an integer, `depth` is 1 + the number of
    hidden layers to use. If `hidden_dims` is a `list`, `depth` must
    be `None`.

activation:
    activation function to use in the hidden layers.

last_activation:
    activation function to use in the last layer.

dropout:
    The ratio of units to dropout. Must be between 0 and 1

last_dropout:
    The ratio of units to dropout for the last layer. Must be between 0 and 1

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

first_normalization:
    Whether to use batch normalization **before** the first layer

last_normalization:
    Whether to use batch normalization in the last layer

residual_type:
    - "none": No residual connection
    - "simple": Residual connection similar to the ResNet architecture.
      See class `ResidualConnectionSimple`
    - "weighted": Residual connection similar to the Resnet architecture,
      but with weights applied before the summation. See class `ResidualConnectionWeighted`
    - "concat": Residual connection where the residual is concatenated instead
      of being added.
    - "densenet": Residual connection where the residual of all previous layers
      are concatenated. This leads to a strong increase in the number of parameters
      if there are multiple hidden layers.

residual_skip_steps:
    The number of steps to skip between each residual connection.
    If `1`, all the layers are connected. If `2`, half of the
    layers are connected.

in_dim_edges:
    Input edge-feature dimensions of the network. Keep at 0 if not using
    edge features, or if the layer doesn't support edges.

hidden_dims_edges:
    Hidden dimensions for the edges. Most models don't support it, so it
    should only be used for those that do, i.e. `GatedGCNLayer`

out_dim_edges:
    Output edge-feature dimensions of the network. Keep at 0 if not using
    edge features, or if the layer doesn't support edges. Defaults to the
    last value of hidden_dims_edges.

name:
    Name attributed to the current network, for display and printing
    purposes.

layer_type:
    The type of layers to use in the network.
    A class that inherits from `graphium.nn.base_graph_layer.BaseGraphStructure`,
    or one of the following strings

    - "pyg:gin": GINConvPyg
    - "pyg:gine": GINEConvPyg
    - "pyg:gated-gcn": GatedGCNPyg
    - "pyg:pna-msgpass": PNAMessagePassingPyg

layer_kwargs:
    The arguments to be used in the initialization of the layer provided by `layer_type`

virtual_node:
    A string associated to the type of virtual node to use,
    either `None`, "none", "mean", "sum", "max", "logsum".
    See `graphium.nn.pooling_pyg.VirtualNode`.

    The virtual node will not use any residual connection if `residual_type`
    is "none". Otherwise, it will use a simple ResNet like residual
    connection.

use_virtual_edges:
    A bool flag used to select if the virtual node should use the edges or not

last_layer_is_readout: Whether the last layer should be treated as a readout layer.
    Allows to use the `mup.MuReadout` from the muTransfer method https://github.com/microsoft/mup
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardGraph.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Controls how the class is printed</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardGraph.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Apply the full graph neural network on the input graph and node features.</p>
<p>Parameters:</p>
<pre><code>g:
    pyg Batch graph on which the convolution is done with the keys:

    - `"feat"`: torch.Tensor[..., N, Din]
      Node feature tensor, before convolution.
      `N` is the number of nodes, `Din` is the input features

    - `"edge_feat"` (torch.Tensor[..., N, Ein]):
      Edge feature tensor, before convolution.
      `N` is the number of nodes, `Ein` is the input edge features
</code></pre>
<p>Returns:</p>
<pre><code>`torch.Tensor[..., M, Dout]` or `torch.Tensor[..., N, Dout]`:
    Node or graph feature tensor, after the network.
    `N` is the number of nodes, `M` is the number of graphs,
    `Dout` is the output dimension ``self.out_dim``
    If the `self.pooling` is [`None`], then it returns node features and the output dimension is `N`,
    otherwise it returns graph features and the output dimension is `M`
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardGraph.get_init_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_init_kwargs</span><span class="p">()</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.get_init_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get a dictionary that can be used to instanciate a new object with identical parameters.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardGraph.get_nested_key" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_nested_key</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">target_key</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.get_nested_key" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the value associated with a key in a nested dictionary.</p>
<p>Parameters:
- d: The dictionary to search in
- target_key: The key to search for</p>
<p>Returns:
- The value associated with the key if found, None otherwise</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardGraph.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">factor_in_dim</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardGraph.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.
factor_in_dim: Whether to factor the input dimension for the nodes</p>
</details>


  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>kwargs</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of parameters to be used to instanciate the base model divided by the factor</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.nn.architectures.global_architectures.FeedForwardNN" class="doc doc-heading">
          <code>FeedForwardNN</code>


<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.nn.Module">Module</span></code>, <code><span title="graphium.nn.utils.MupMixin">MupMixin</span></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardNN.cache_readouts" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cache_readouts</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.cache_readouts" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Whether the readout cache is enabled</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardNN.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">hidden_dims</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">last_activation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">last_dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">first_normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">last_normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">residual_type</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">residual_skip_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LNN&#39;</span><span class="p">,</span> <span class="n">layer_type</span><span class="o">=</span><span class="s1">&#39;fc&#39;</span><span class="p">,</span> <span class="n">layer_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">last_layer_is_readout</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>A flexible neural network architecture, with variable hidden dimensions,
support for multiple layer types, and support for different residual
connections.</p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the layer

out_dim:
    Output feature dimensions of the layer

hidden_dims:
    Either an integer specifying all the hidden dimensions,
    or a list of dimensions in the hidden layers.
    Be careful, the "simple" residual type only supports
    hidden dimensions of the same value.

depth:
    If `hidden_dims` is an integer, `depth` is 1 + the number of
    hidden layers to use.
    If `hidden_dims` is a list, then
    `depth` must be `None` or equal to `len(hidden_dims) + 1`

activation:
    activation function to use in the hidden layers.

last_activation:
    activation function to use in the last layer.

dropout:
    The ratio of units to dropout. Must be between 0 and 1

last_dropout:
    The ratio of units to dropout for the last_layer. Must be between 0 and 1

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

first_normalization:
    Whether to use batch normalization **before** the first layer

last_normalization:
    Whether to use batch normalization in the last layer

residual_type:
    - "none": No residual connection
    - "simple": Residual connection similar to the ResNet architecture.
      See class `ResidualConnectionSimple`
    - "weighted": Residual connection similar to the Resnet architecture,
      but with weights applied before the summation. See class `ResidualConnectionWeighted`
    - "concat": Residual connection where the residual is concatenated instead
      of being added.
    - "densenet": Residual connection where the residual of all previous layers
      are concatenated. This leads to a strong increase in the number of parameters
      if there are multiple hidden layers.

residual_skip_steps:
    The number of steps to skip between each residual connection.
    If `1`, all the layers are connected. If `2`, half of the
    layers are connected.

name:
    Name attributed to the current network, for display and printing
    purposes.

layer_type:
    The type of layers to use in the network.
    Either "fc" as the `FCLayer`, or a class representing the `nn.Module`
    to use.

layer_kwargs:
    The arguments to be used in the initialization of the layer provided by `layer_type`

last_layer_is_readout: Whether the last layer should be treated as a readout layer.
    Allows to use the `mup.MuReadout` from the muTransfer method https://github.com/microsoft/mup
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardNN.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Controls how the class is printed</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardNN.add_layers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_layers</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.add_layers" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Add layers to the end of the model.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardNN.drop_layers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">drop_layers</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.drop_layers" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Remove the last layers of the model part.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardNN.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Apply the neural network on the input features.</p>
<p>Parameters:</p>
<pre><code>h: `torch.Tensor[..., Din]`:
    Input feature tensor, before the network.
    `Din` is the number of input features
</code></pre>
<p>Returns:</p>
<pre><code>`torch.Tensor[..., Dout]`:
    Output feature tensor, after the network.
    `Dout` is the number of output features
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardNN.get_init_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_init_kwargs</span><span class="p">()</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.get_init_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get a dictionary that can be used to instanciate a new object with identical parameters.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FeedForwardNN.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">factor_in_dim</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FeedForwardNN.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.
factor_in_dim: Whether to factor the input dimension</p>
</details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork" class="doc doc-heading">
          <code>FullGraphMultiTaskNetwork</code>


<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.nn.Module">Module</span></code>, <code><span title="graphium.nn.utils.MupMixin">MupMixin</span></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.in_dim" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">in_dim</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.in_dim" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the input dimension of the network</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.in_dim_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">in_dim_edges</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.in_dim_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the input edge dimension of the network</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.out_dim" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.out_dim" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the output dimension of the network</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.out_dim_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim_edges</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.out_dim_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the output dimension of the edges
of the network.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">gnn_kwargs</span><span class="p">,</span> <span class="n">pre_nn_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pre_nn_edges_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pe_encoders_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_heads_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">graph_output_nn_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">accelerator_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_inference_to_average</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">last_layer_is_readout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;FullGNN&#39;</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Class that allows to implement a full graph neural network architecture,
including the pre-processing MLP and the post processing MLP.</p>
<p>Parameters:</p>
<pre><code>gnn_kwargs:
    key-word arguments to use for the initialization of the pre-processing
    GNN network using the class `FeedForwardGraph`.
    It must respect the following criteria:

    - gnn_kwargs["in_dim"] must be equal to pre_nn_kwargs["out_dim"]
    - gnn_kwargs["out_dim"] must be equal to graph_output_nn_kwargs["in_dim"]

pe_encoders_kwargs:
    key-word arguments to use for the initialization of all positional encoding encoders.
    See the class `EncoderManager` for more details.

pre_nn_kwargs:
    key-word arguments to use for the initialization of the pre-processing
    MLP network of the node features before the GNN, using the class `FeedForwardNN`.
    If `None`, there won't be a pre-processing MLP.

pre_nn_edges_kwargs:
    key-word arguments to use for the initialization of the pre-processing
    MLP network of the edge features before the GNN, using the class `FeedForwardNN`.
    If `None`, there won't be a pre-processing MLP.

task_heads_kwargs:
    This argument is a list of dictionaries containing the arguments for task heads. Each argument is used to
    initialize a task-specific MLP.

graph_output_nn_kwargs:
    This argument is a list of dictionaries corresponding to the arguments for a FeedForwardNN.
    Each dict of arguments is used to initialize a shared MLP.

accelerator_kwargs:
    key-word arguments specific to the accelerator being used,
    e.g. pipeline split points

num_inference_to_average:
    Number of inferences to average at val/test time. This is used to avoid the noise introduced
    by positional encodings with sign-flips. In case no such encoding is given,
    this parameter is ignored.
    NOTE: The inference time will be slowed-down proportionaly to this parameter.

last_layer_is_readout: Whether the last layer should be treated as a readout layer.
    Allows to use the `mup.MuReadout` from the muTransfer method https://github.com/microsoft/mup

name:
    Name attributed to the current network, for display and printing
    purposes.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Controls how the class is printed</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.create_module_map" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_module_map</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;layers&#39;</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.create_module_map" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Function to create mapping between each (sub)module name and corresponding nn.ModuleList() (if possible);
Used for finetuning when (partially) loading or freezing specific modules of the pretrained model</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>level</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Literal">Literal</span>[&#39;layers&#39;], <span title="typing.Literal">Literal</span>[&#39;module&#39;]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to map to the module object or the layers of the module object</p>
            </div>
          </td>
          <td>
                <code>&#39;layers&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Apply the pre-processing neural network, the graph neural network,
and the post-processing neural network on the graph features.</p>
<p>Parameters:</p>
<pre><code>g:
    pyg Batch graph on which the convolution is done.
    Must contain the following elements:

    - Node key `"feat"`: `torch.Tensor[..., N, Din]`.
      Input node feature tensor, before the network.
      `N` is the number of nodes, `Din` is the input features dimension ``self.pre_nn.in_dim``

    - Edge key `"edge_feat"`: `torch.Tensor[..., N, Ein]` **Optional**.
      The edge features to use. It will be ignored if the
      model doesn't supporte edge features or if
      `self.in_dim_edges==0`.

    - Other keys related to positional encodings `"pos_enc_feats_sign_flip"`,
      `"pos_enc_feats_no_flip"`.
</code></pre>
<p>Returns:</p>
<pre><code>`torch.Tensor[..., M, Dout]` or `torch.Tensor[..., N, Dout]`:
    Node or graph feature tensor, after the network.
    `N` is the number of nodes, `M` is the number of graphs,
    `Dout` is the output dimension ``self.graph_output_nn.out_dim``
    If the `self.gnn.pooling` is [`None`], then it returns node features and the output dimension is `N`,
    otherwise it returns graph features and the output dimension is `M`
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.</p>
</details>


  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the kwargs to create the base model.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.set_max_num_nodes_edges_per_graph" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_max_num_nodes_edges_per_graph</span><span class="p">(</span><span class="n">max_nodes</span><span class="p">,</span> <span class="n">max_edges</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork.set_max_num_nodes_edges_per_graph" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Set the maximum number of nodes and edges for all gnn layers and encoder layers</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>max_nodes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of nodes in the dataset.
This will be useful for certain architecture, but ignored by others.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_edges</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of edges in the dataset.
This will be useful for certain architecture, but ignored by others.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.nn.architectures.global_architectures.GraphOutputNN" class="doc doc-heading">
          <code>GraphOutputNN</code>


<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.nn.Module">Module</span></code>, <code><span title="graphium.nn.utils.MupMixin">MupMixin</span></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.concat_last_layers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">concat_last_layers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.concat_last_layers" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Property to control the output of the <code>self.forward</code>.
If set to a list of integer, the <code>forward</code> function will
concatenate the output of different layers.</p>
<p>If set to <code>None</code>, the output of the last layer is returned.</p>
<p>NOTE: The indexes are inverted. 0 is the last layer, 1 is the second last, etc.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.out_dim" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.out_dim" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the output dimension of the network</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="p">,</span> <span class="n">task_level</span><span class="p">,</span> <span class="n">graph_output_nn_kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>in_dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input feature dimensions of the layer</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>in_dim_edges</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input edge feature dimensions of the layer</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_level</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>graph/node/edge/nodepair depending on wether it is graph/node/edge/nodepair level task</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>graph_output_nn_kwargs</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>key-word arguments to use for the initialization of the post-processing
MLP network after the GNN, using the class <code>FeedForwardNN</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.compute_nodepairs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_nodepairs</span><span class="p">(</span><span class="n">node_feats</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">max_num_nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drop_nodes_last_graph</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.compute_nodepairs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Vectorized implementation of nodepair-level task:
Parameters:
    node_feats: Node features
    batch: Batch vector
    max_num_nodes: The maximum number of nodes per graph
    fill_value: The value for invalid entries in the
        resulting dense output tensor. (default: :obj:<code>NaN</code>)
    batch_size: The batch size. (default: :obj:<code>None</code>)
    drop_nodes_last_graph: Whether to drop the nodes of the last graphs that exceed
        the <code>max_num_nodes_per_graph</code>. Useful when the last graph is a padding.
Returns:
    result: concatenated node features of shape B * max_num_nodes * 2*h,
    where B is number of graphs, max_num_nodes is the chosen maximum number nodes, and h is the feature dim</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.drop_graph_output_nn_layers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">drop_graph_output_nn_layers</span><span class="p">(</span><span class="n">num_layers_to_drop</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.drop_graph_output_nn_layers" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Remove the last layers of the model. Useful for Transfer Learning.
Parameters:
    num_layers_to_drop: The number of layers to drop from the <code>self.graph_output_nn</code> network.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.extend_graph_output_nn_layers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extend_graph_output_nn_layers</span><span class="p">(</span><span class="n">layers</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.extend_graph_output_nn_layers" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Add layers at the end of the model. Useful for Transfer Learning.
Parameters:
    layers: A ModuleList of all the layers to extend</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>g</code></td>
          <td>
                <code><span title="torch_geometric.data.Batch">Batch</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pyg Batch graph</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    h: Output features after applying graph_output_nn</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">factor_in_dim</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.
factor_in_dim: Whether to factor the input dimension</p>
</details>


  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the kwargs to create the base model.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.GraphOutputNN.set_max_num_nodes_edges_per_graph" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_max_num_nodes_edges_per_graph</span><span class="p">(</span><span class="n">max_nodes</span><span class="p">,</span> <span class="n">max_edges</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.GraphOutputNN.set_max_num_nodes_edges_per_graph" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Set the maximum number of nodes and edges for all gnn layers and encoder layers</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>max_nodes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of nodes in the dataset.
This will be useful for certain architecture, but ignored by others.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_edges</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of edges in the dataset.
This will be useful for certain architecture, but ignored by others.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.nn.architectures.global_architectures.TaskHeads" class="doc doc-heading">
          <code>TaskHeads</code>


<a href="#graphium.nn.architectures.global_architectures.TaskHeads" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.nn.Module">Module</span></code>, <code><span title="graphium.nn.utils.MupMixin">MupMixin</span></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.global_architectures.TaskHeads.out_dim" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.global_architectures.TaskHeads.out_dim" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the output dimension of each task head</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.TaskHeads.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="p">,</span> <span class="n">task_heads_kwargs</span><span class="p">,</span> <span class="n">graph_output_nn_kwargs</span><span class="p">,</span> <span class="n">last_layer_is_readout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.TaskHeads.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Class that groups all multi-task output heads together to provide the task-specific outputs.
Parameters:
    in_dim:
        Input feature dimensions of the layer</p>
<pre><code>in_dim_edges:
    Input edge feature dimensions of the layer
last_layer_is_readout: Whether the last layer should be treated as a readout layer.
    Allows to use the `mup.MuReadout` from the muTransfer method
task_heads_kwargs:
    This argument is a list of dictionaries corresponding to the arguments for a FeedForwardNN.
    Each dict of arguments is used to initialize a task-specific MLP.
graph_output_nn_kwargs:
    key-word arguments to use for the initialization of the post-processing
    MLP network after the GNN, using the class `FeedForwardNN`.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.TaskHeads.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#graphium.nn.architectures.global_architectures.TaskHeads.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns a string representation of the task heads</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.TaskHeads.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.TaskHeads.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>forward function of the task head
Parameters:
    g: pyg Batch graph
Returns:
    task_head_outputs: Return a dictionary: Dict[task_name, Tensor]</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.TaskHeads.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">factor_in_dim</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.TaskHeads.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.
factor_in_dim: Whether to factor the input dimension</p>
</details>


  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>kwargs</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of arguments to be used to initialize the base model</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.global_architectures.TaskHeads.set_max_num_nodes_edges_per_graph" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_max_num_nodes_edges_per_graph</span><span class="p">(</span><span class="n">max_nodes</span><span class="p">,</span> <span class="n">max_edges</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.global_architectures.TaskHeads.set_max_num_nodes_edges_per_graph" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Set the maximum number of nodes and edges for all gnn layers and encoder layers</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>max_nodes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of nodes in the dataset.
This will be useful for certain architecture, but ignored by others.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_edges</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of edges in the dataset.
This will be useful for certain architecture, but ignored by others.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="pyg-architectures">PyG Architectures<a class="headerlink" href="#pyg-architectures" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">



<h3 id="graphium.nn.architectures.pyg_architectures" class="doc doc-heading">
          <code>graphium.nn.architectures.pyg_architectures</code>


<a href="#graphium.nn.architectures.pyg_architectures" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">
  
      <hr />
<p>Copyright (c) 2023 Valence Labs, Recursion Pharmaceuticals and Graphcore Limited.</p>
<p>Use of this software is subject to the terms and conditions outlined in the LICENSE file.
Unauthorized modification, distribution, or use is prohibited. Provided 'as is' without
warranties of any kind.</p>
<p>Valence Labs, Recursion Pharmaceuticals and Graphcore Limited are not liable for any damages arising from its use.
Refer to the LICENSE file for the full terms and conditions.</p>
<hr />

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="graphium.nn.architectures.pyg_architectures.FeedForwardPyg" class="doc doc-heading">
          <code>FeedForwardPyg</code>


<a href="#graphium.nn.architectures.pyg_architectures.FeedForwardPyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.nn.architectures.global_architectures.FeedForwardGraph" href="#graphium.nn.architectures.global_architectures.FeedForwardGraph">FeedForwardGraph</a></code></p>



  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div><h2 id="encoder-manager">Encoder Manager<a class="headerlink" href="#encoder-manager" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">



<h3 id="graphium.nn.architectures.encoder_manager" class="doc doc-heading">
          <code>graphium.nn.architectures.encoder_manager</code>


<a href="#graphium.nn.architectures.encoder_manager" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">
  
      <hr />
<p>Copyright (c) 2023 Valence Labs, Recursion Pharmaceuticals and Graphcore Limited.</p>
<p>Use of this software is subject to the terms and conditions outlined in the LICENSE file.
Unauthorized modification, distribution, or use is prohibited. Provided 'as is' without
warranties of any kind.</p>
<p>Valence Labs, Recursion Pharmaceuticals and Graphcore Limited are not liable for any damages arising from its use.
Refer to the LICENSE file for the full terms and conditions.</p>
<hr />

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="graphium.nn.architectures.encoder_manager.EncoderManager" class="doc doc-heading">
          <code>EncoderManager</code>


<a href="#graphium.nn.architectures.encoder_manager.EncoderManager" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.nn.Module">Module</span></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.encoder_manager.EncoderManager.in_dims" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">in_dims</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.encoder_manager.EncoderManager.in_dims" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the input dimensions for all pe-encoders</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>in_dims</code></td>          <td>
                <code><span title="typing.Iterable">Iterable</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the input dimensions for all pe-encoders</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.encoder_manager.EncoderManager.input_keys" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">input_keys</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.encoder_manager.EncoderManager.input_keys" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the input keys for all pe-encoders</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>input_keys</code></td>          <td>
                <code><span title="typing.Iterable">Iterable</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the input keys for all pe-encoders</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.nn.architectures.encoder_manager.EncoderManager.out_dim" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.architectures.encoder_manager.EncoderManager.out_dim" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the output dimension of the pooled embedding from all the pe encoders</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>out_dim</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the output dimension of the pooled embedding from all the pe encoders</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>




<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.encoder_manager.EncoderManager.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">pe_encoders_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_num_nodes_per_graph</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;encoder_manager&#39;</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.encoder_manager.EncoderManager.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Class that allows to runs multiple encoders in parallel and concatenate / pool their outputs.
Parameters:</p>
<pre><code>pe_encoders_kwargs:
    key-word arguments to use for the initialization of all positional encoding encoders
    can use the class PE_ENCODERS_DICT: "la_encoder"(tested) , "mlp_encoder" (not tested), "signnet_encoder" (not tested)

name:
    Name attributed to the current network, for display and printing
    purposes.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.encoder_manager.EncoderManager.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>forward pass of the pe encoders and pooling</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>g</code></td>
          <td>
                <code><span title="torch_geometric.data.Batch">Batch</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ptg Batch on which the convolution is done.
Must contain the following elements:</p>
<ul>
<li>
<p>Node key <code>"feat"</code>: <code>torch.Tensor[..., N, Din]</code>.
  Input node feature tensor, before the network.
  <code>N</code> is the number of nodes, <code>Din</code> is the input features dimension <code>self.pre_nn.in_dim</code></p>
</li>
<li>
<p>Edge key <code>"edge_feat"</code>: <code>torch.Tensor[..., N, Ein]</code> <strong>Optional</strong>.
  The edge features to use. It will be ignored if the
  model doesn't supporte edge features or if
  <code>self.in_dim_edges==0</code>.</p>
</li>
<li>
<p>Other keys related to positional encodings <code>"pos_enc_feats_sign_flip"</code>,
  <code>"pos_enc_feats_no_flip"</code>.</p>
</li>
</ul>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>g</code></td>          <td>
                <code><span title="torch_geometric.data.Batch">Batch</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pyg Batch with the positional encodings added to the graph</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.encoder_manager.EncoderManager.forward_positional_encoding" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward_positional_encoding</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward_positional_encoding" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Forward pass for the positional encodings (PE),
with each PE having it's own encoder defined in <code>self.pe_encoders</code>.
All the positional encodings with the same keys are pooled together
using <code>self.pe_pooling</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>g</code></td>
          <td>
                <code><span title="torch_geometric.data.Batch">Batch</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pyg Batch containing the node positional encodings</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pe_node_pooled</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="torch.Tensor">Tensor</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The positional / structural encodings go through</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="torch.Tensor">Tensor</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>encoders, then are pooled together according to their keys.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.encoder_manager.EncoderManager.forward_simple_pooling" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward_simple_pooling</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">pooling</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.encoder_manager.EncoderManager.forward_simple_pooling" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Apply sum, mean, or max pooling on a Tensor.
Parameters:
    h: the Tensor to pool
    pooling: string specifiying the pooling method
    dim: the dimension to pool over</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pooled</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the pooled Tensor</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.nn.architectures.encoder_manager.EncoderManager.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span></code>

<a href="#graphium.nn.architectures.encoder_manager.EncoderManager.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.</p>
</details>


  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>pe_kw</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the model kwargs where the dimensions are divided by the factor</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2020 - 2023 datamol.io
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.expand"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../_assets/js/google-analytics.js"></script>
      
    
  </body>
</html>