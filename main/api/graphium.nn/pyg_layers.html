
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Graphium: Scaling molecular GNNs to infinity.">
      
      
      
        <link rel="canonical" href="https://github.com/datamol-io/graphium/main/api/graphium.nn/pyg_layers.html">
      
      
        <link rel="prev" href="encoders.html">
      
      
        <link rel="next" href="../graphium.features.html">
      
      
      <link rel="icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.5">
    
    
      
        <title>graphium.nn.pyg_layers - graphium</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6a10b989.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../_assets/css/custom.css">
    
      <link rel="stylesheet" href="../../_assets/css/custom-graphium.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#graphiumnnpyg_layers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="graphium" class="md-header__button md-logo" aria-label="graphium" data-md-component="logo">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            graphium
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              graphium.nn.pyg_layers
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/datamol-io/graphium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    valence-discovery/graphium
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../baseline.html" class="md-tabs__link">
        
  
    
  
  Baseline

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="graphium.nn.html" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/feature_processing/add_new_positional_encoding.html" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../design.html" class="md-tabs__link">
        
  
    
  
  Design

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../datasets.html" class="md-tabs__link">
        
  
    
  
  Datasets

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pretrained_models.html" class="md-tabs__link">
        
  
    
  
  Pretrained Models

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cli/reference.html" class="md-tabs__link">
          
  
  CLI

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../contribute.html" class="md-tabs__link">
        
  
    
  
  Contribute

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../license.html" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="graphium" class="md-nav__button md-logo" aria-label="graphium" data-md-component="logo">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    graphium
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/datamol-io/graphium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    valence-discovery/graphium
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../baseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Baseline
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    graphium.nn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            graphium.nn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="architectures.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn.architectures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="encoders.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn.encoders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    graphium.nn.pyg_layers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="pyg_layers.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    graphium.nn.pyg_layers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gated-gcn-layer" class="md-nav__link">
    Gated GCN Layer
  </a>
  
    <nav class="md-nav" aria-label="Gated GCN Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg" class="md-nav__link">
    gated_gcn_pyg
  </a>
  
    <nav class="md-nav" aria-label="gated_gcn_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg" class="md-nav__link">
    GatedGCNPyg
  </a>
  
    <nav class="md-nav" aria-label="GatedGCNPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.aggregate" class="md-nav__link">
    aggregate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.message" class="md-nav__link">
    message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gps-layer" class="md-nav__link">
    GPS Layer
  </a>
  
    <nav class="md-nav" aria-label="GPS Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg" class="md-nav__link">
    gps_pyg
  </a>
  
    <nav class="md-nav" aria-label="gps_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg" class="md-nav__link">
    GPSLayerPyg
  </a>
  
    <nav class="md-nav" aria-label="GPSLayerPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.residual_add" class="md-nav__link">
    residual_add()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.scale_activations" class="md-nav__link">
    scale_activations()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gin-and-gine-layers" class="md-nav__link">
    GIN and GINE Layers
  </a>
  
    <nav class="md-nav" aria-label="GIN and GINE Layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg" class="md-nav__link">
    gin_pyg
  </a>
  
    <nav class="md-nav" aria-label="gin_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg" class="md-nav__link">
    GINConvPyg
  </a>
  
    <nav class="md-nav" aria-label="GINConvPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg" class="md-nav__link">
    GINEConvPyg
  </a>
  
    <nav class="md-nav" aria-label="GINEConvPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpnn-layer" class="md-nav__link">
    MPNN Layer
  </a>
  
    <nav class="md-nav" aria-label="MPNN Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg" class="md-nav__link">
    mpnn_pyg
  </a>
  
    <nav class="md-nav" aria-label="mpnn_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg" class="md-nav__link">
    MPNNPlusPyg
  </a>
  
    <nav class="md-nav" aria-label="MPNNPlusPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.aggregate_features" class="md-nav__link">
    aggregate_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.gather_features" class="md-nav__link">
    gather_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pna-layer" class="md-nav__link">
    PNA Layer
  </a>
  
    <nav class="md-nav" aria-label="PNA Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg" class="md-nav__link">
    pna_pyg
  </a>
  
    <nav class="md-nav" aria-label="pna_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg" class="md-nav__link">
    PNAMessagePassingPyg
  </a>
  
    <nav class="md-nav" aria-label="PNAMessagePassingPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.aggregate" class="md-nav__link">
    aggregate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.message" class="md-nav__link">
    message()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pooling-layers" class="md-nav__link">
    Pooling Layers
  </a>
  
    <nav class="md-nav" aria-label="Pooling Layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg" class="md-nav__link">
    pooling_pyg
  </a>
  
    <nav class="md-nav" aria-label="pooling_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.PoolingWrapperPyg" class="md-nav__link">
    PoolingWrapperPyg
  </a>
  
    <nav class="md-nav" aria-label="PoolingWrapperPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.PoolingWrapperPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg" class="md-nav__link">
    VirtualNodePyg
  </a>
  
    <nav class="md-nav" aria-label="VirtualNodePyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.parse_pooling_layer_pyg" class="md-nav__link">
    parse_pooling_layer_pyg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.scatter_logsum_pool" class="md-nav__link">
    scatter_logsum_pool()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.scatter_std_pool" class="md-nav__link">
    scatter_std_pool()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    Utils
  </a>
  
    <nav class="md-nav" aria-label="Utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.GaussianLayer" class="md-nav__link">
    GaussianLayer
  </a>
  
    <nav class="md-nav" aria-label="GaussianLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.GaussianLayer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.PreprocessPositions" class="md-nav__link">
    PreprocessPositions
  </a>
  
    <nav class="md-nav" aria-label="PreprocessPositions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.PreprocessPositions.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.PreprocessPositions.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.triplets" class="md-nav__link">
    triplets()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.trainer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.ipu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.ipu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.visualization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../graphium.finetuning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.finetuning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    feature_processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            feature_processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/feature_processing/add_new_positional_encoding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add new positional encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/feature_processing/csv_to_parquet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert CSV to Parquet files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/feature_processing/timing_parallel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timing parallel processing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    gnn_layers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            gnn_layers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gnn/add_new_gnn_layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating GNN layers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gnn/making_gnn_networks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Making GNN Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/gnn/using_gnn_layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using GNN layers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    model_training
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            model_training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/model_training/simple-molecular-model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building and training a simple model from configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/model_training/running-multitask-ipu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multitask Molecular Modelling with Graphium on the IPU
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../design.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../pretrained_models.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pretrained Models
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CLI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            CLI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/reference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/graphium.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/graphium-train.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium-train
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../contribute.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../license.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gated-gcn-layer" class="md-nav__link">
    Gated GCN Layer
  </a>
  
    <nav class="md-nav" aria-label="Gated GCN Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg" class="md-nav__link">
    gated_gcn_pyg
  </a>
  
    <nav class="md-nav" aria-label="gated_gcn_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg" class="md-nav__link">
    GatedGCNPyg
  </a>
  
    <nav class="md-nav" aria-label="GatedGCNPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.aggregate" class="md-nav__link">
    aggregate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.message" class="md-nav__link">
    message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.update" class="md-nav__link">
    update()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gps-layer" class="md-nav__link">
    GPS Layer
  </a>
  
    <nav class="md-nav" aria-label="GPS Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg" class="md-nav__link">
    gps_pyg
  </a>
  
    <nav class="md-nav" aria-label="gps_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg" class="md-nav__link">
    GPSLayerPyg
  </a>
  
    <nav class="md-nav" aria-label="GPSLayerPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.residual_add" class="md-nav__link">
    residual_add()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.scale_activations" class="md-nav__link">
    scale_activations()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gin-and-gine-layers" class="md-nav__link">
    GIN and GINE Layers
  </a>
  
    <nav class="md-nav" aria-label="GIN and GINE Layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg" class="md-nav__link">
    gin_pyg
  </a>
  
    <nav class="md-nav" aria-label="gin_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg" class="md-nav__link">
    GINConvPyg
  </a>
  
    <nav class="md-nav" aria-label="GINConvPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg" class="md-nav__link">
    GINEConvPyg
  </a>
  
    <nav class="md-nav" aria-label="GINEConvPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpnn-layer" class="md-nav__link">
    MPNN Layer
  </a>
  
    <nav class="md-nav" aria-label="MPNN Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg" class="md-nav__link">
    mpnn_pyg
  </a>
  
    <nav class="md-nav" aria-label="mpnn_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg" class="md-nav__link">
    MPNNPlusPyg
  </a>
  
    <nav class="md-nav" aria-label="MPNNPlusPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.aggregate_features" class="md-nav__link">
    aggregate_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.gather_features" class="md-nav__link">
    gather_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pna-layer" class="md-nav__link">
    PNA Layer
  </a>
  
    <nav class="md-nav" aria-label="PNA Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg" class="md-nav__link">
    pna_pyg
  </a>
  
    <nav class="md-nav" aria-label="pna_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg" class="md-nav__link">
    PNAMessagePassingPyg
  </a>
  
    <nav class="md-nav" aria-label="PNAMessagePassingPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_inputs_edges" class="md-nav__link">
    layer_inputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_outputs_edges" class="md-nav__link">
    layer_outputs_edges
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.out_dim_factor" class="md-nav__link">
    out_dim_factor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.aggregate" class="md-nav__link">
    aggregate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_supports_edges" class="md-nav__link">
    layer_supports_edges()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.message" class="md-nav__link">
    message()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pooling-layers" class="md-nav__link">
    Pooling Layers
  </a>
  
    <nav class="md-nav" aria-label="Pooling Layers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg" class="md-nav__link">
    pooling_pyg
  </a>
  
    <nav class="md-nav" aria-label="pooling_pyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.PoolingWrapperPyg" class="md-nav__link">
    PoolingWrapperPyg
  </a>
  
    <nav class="md-nav" aria-label="PoolingWrapperPyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.PoolingWrapperPyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg" class="md-nav__link">
    VirtualNodePyg
  </a>
  
    <nav class="md-nav" aria-label="VirtualNodePyg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.parse_pooling_layer_pyg" class="md-nav__link">
    parse_pooling_layer_pyg()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.scatter_logsum_pool" class="md-nav__link">
    scatter_logsum_pool()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.pooling_pyg.scatter_std_pool" class="md-nav__link">
    scatter_std_pool()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    Utils
  </a>
  
    <nav class="md-nav" aria-label="Utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.GaussianLayer" class="md-nav__link">
    GaussianLayer
  </a>
  
    <nav class="md-nav" aria-label="GaussianLayer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.GaussianLayer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.PreprocessPositions" class="md-nav__link">
    PreprocessPositions
  </a>
  
    <nav class="md-nav" aria-label="PreprocessPositions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.PreprocessPositions.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.PreprocessPositions.forward" class="md-nav__link">
    forward()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.nn.pyg_layers.utils.triplets" class="md-nav__link">
    triplets()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="graphiumnnpyg_layers">graphium.nn.pyg_layers<a class="headerlink" href="#graphiumnnpyg_layers" title="Permanent link">&para;</a></h1>
<p>Implementations of GNN layers based on PyG in the library</p>
<div class="tabbed-set" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Contents</label><div class="tabbed-content">
<ul>
<li><a href="#gated-gcn-layer">Gated GCN Layer</a></li>
<li><a href="#gps-layer">GPS Layer</a></li>
<li><a href="#gin-and-gine-layers">GIN and GINE Layers</a></li>
<li><a href="#mpnn-layer">MPNN Layer</a></li>
<li><a href="#pna-layer">PNA Layer</a></li>
<li><a href="#pooling-layers">Pooling Layer</a></li>
</ul>
</div>
</div>
<h2 id="gated-gcn-layer">Gated GCN Layer<a class="headerlink" href="#gated-gcn-layer" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">




<h3 id="graphium.nn.pyg_layers.gated_gcn_pyg" class="doc doc-heading">
          <code>graphium.nn.pyg_layers.gated_gcn_pyg</code>


<a href="#graphium.nn.pyg_layers.gated_gcn_pyg" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">
  
      <p>Unit tests for the different layers of graphium/nn/pyg_layers/...</p>
<p>The layers are not thoroughly tested due to the difficulty of testing them</p>
<p>adapated from <a href="https://github.com/rampasek/GraphGPS/blob/main/graphgps/layer/gps_layer.py">https://github.com/rampasek/GraphGPS/blob/main/graphgps/layer/gps_layer.py</a></p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg" class="doc doc-heading">
          <code>GatedGCNPyg</code>


<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch_geometric.nn.conv.MessagePassing">MessagePassing</span></code>, <code><a class="autorefs autorefs-internal" title="graphium.nn.base_graph_layer.BaseGraphStructure" href="graphium.nn.html#graphium.nn.base_graph_layer.BaseGraphStructure">BaseGraphStructure</a></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_inputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_inputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_inputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Always <code>True</code> for the current class</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_outputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_outputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_outputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Abstract method. Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Always <code>True</code> for the current class</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.out_dim_factor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim_factor</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.out_dim_factor" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the factor by which the output dimension is multiplied for
the next layer.</p>
<p>For standard layers, this will return <code>1</code>.</p>
<p>But for others, such as <code>GatLayer</code>, the output is the concatenation
of the outputs from each head, so the out_dim gets multiplied by
the number of heads, and this function should return the number
of heads.</p>
<p>Returns:</p>
<pre><code>int:
    Always ``1`` for the current class
</code></pre>
  </div>

</div>




<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="p">,</span> <span class="n">out_dim_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>ResGatedGCN: Residual Gated Graph ConvNets
An Experimental Study of Neural Networks for Variable Graphs (Xavier Bresson and Thomas Laurent, ICLR 2018)
<a href="https://arxiv.org/pdf/1711.07553v2.pdf">https://arxiv.org/pdf/1711.07553v2.pdf</a></p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the layer

out_dim:
    Output feature dimensions of the layer, and for the edges

in_dim_edges:
    Input edge-feature dimensions of the layer

activation:
    activation function to use in the layer

dropout:
    The ratio of units to dropout. Must be between 0 and 1

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

eps:
    Epsilon value for the normalization `sum(gate_weights * messages) / (sum(gate_weights) + eps)`,
    where `gate_weights` are the weights of the gates and follow a sigmoid function.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.aggregate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">aggregate</span><span class="p">(</span><span class="n">sigma_ij</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">Bx_j</span><span class="p">,</span> <span class="n">Bx</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.aggregate" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>aggregation function of the layer
Parameters:
    sigma_ij: the output from message() function with dim [n_edges, out_dim]
    index: dim [n_edges]
    Bx_j: dim [n_edges, out_dim]
    Bx: dim [n_nodes, out_dim]
Returns:
    out: dim [n_nodes, out_dim]</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Forward pass the Gated GCN layer
extract the following from the batch:
x, node features with dim [n_nodes, in_dim]
e, edge features with dim [n_edges, in_dim]
edge_index with dim [2, n_edges]</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>batch</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="torch_geometric.data.Data">Data</span>, <span title="torch_geometric.data.Batch">Batch</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pyg Batch graph to pass through the layer</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    batch: pyg Batch graph</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_supports_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_supports_edges</span><span class="p">()</span></code>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.layer_supports_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type supports edges or not.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Always <code>True</code> for the current class</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.message" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">message</span><span class="p">(</span><span class="n">Dx_i</span><span class="p">,</span> <span class="n">Ex_j</span><span class="p">,</span> <span class="n">Ce</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.message" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>message function
Parameters:
    Dx_i: tensor with dimension [n_edges, out_dim]
    Ex_j: tensor with dimension [n_edges, out_dim]
    Ce: tensor with dimension [n_edges, out_dim]
Returns:
    sigma_ij: tensor with dimension [n_edges, out_dim]</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.update" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">aggr_out</span><span class="p">,</span> <span class="n">Ax</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gated_gcn_pyg.GatedGCNPyg.update" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>update function of the layer
Parameters:
    aggr_out: the output from aggregate() function with dim [n_nodes, out_dim]
    Ax: tensor with dim [n_nodes, out_dim]
Returns:
    x: dim [n_nodes, out_dim]
    e_out: dim [n_edges, out_dim_edges]</p>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="gps-layer">GPS Layer<a class="headerlink" href="#gps-layer" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">




<h3 id="graphium.nn.pyg_layers.gps_pyg" class="doc doc-heading">
          <code>graphium.nn.pyg_layers.gps_pyg</code>


<a href="#graphium.nn.pyg_layers.gps_pyg" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg" class="doc doc-heading">
          <code>GPSLayerPyg</code>


<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.nn.base_graph_layer.BaseGraphModule" href="graphium.nn.html#graphium.nn.base_graph_layer.BaseGraphModule">BaseGraphModule</a></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_inputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_inputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_inputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``True`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_outputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_outputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_outputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Abstract method. Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``False`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.out_dim_factor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim_factor</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.out_dim_factor" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the factor by which the output dimension is multiplied for
the next layer.</p>
<p>For standard layers, this will return <code>1</code>.</p>
<p>But for others, such as <code>GatLayer</code>, the output is the concatenation
of the outputs from each head, so the out_dim gets multiplied by
the number of heads, and this function should return the number
of heads.</p>
<p>Returns:</p>
<pre><code>int:
    Always ``1`` for the current class
</code></pre>
  </div>

</div>




<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_dim_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">node_residual</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">mpnn_type</span><span class="o">=</span><span class="s1">&#39;pyg:gine&#39;</span><span class="p">,</span> <span class="n">mpnn_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attn_type</span><span class="o">=</span><span class="s1">&#39;full-attention&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;32&#39;</span><span class="p">,</span> <span class="n">biased_attention_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attn_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">droppath_rate_attn</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">droppath_rate_ffn</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hidden_dim_scaling</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">output_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>GPS layer implementation in pyg
adapated from <a href="https://github.com/rampasek/GraphGPS/blob/main/graphgps/layer/gps_layer.py">https://github.com/rampasek/GraphGPS/blob/main/graphgps/layer/gps_layer.py</a>
GPS: Recipe for a General, Powerful, Scalable Graph Transformer
Ladislav Rampek, Mikhail Galkin, Vijay Prakash Dwivedi, Anh Tuan Luu, Guy Wolf, Dominique Beaini
<a href="https://arxiv.org/abs/2205.12454">https://arxiv.org/abs/2205.12454</a></p>
<p>GPS++: An Optimised Hybrid MPNN/Transformer for Molecular Property Prediction
Dominic Masters, Josef Dean, Kerstin Klaser, Zhiyi Li, Sam Maddrell-Mander, Adam Sanders, Hatem Helal, Deniz Beker, Ladislav Rampek, Dominique Beaini
<a href="https://arxiv.org/abs/2212.02229">https://arxiv.org/abs/2212.02229</a></p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input node feature dimensions of the layer

out_dim:
    Output node feature dimensions of the layer

in_dim:
    Input edge feature dimensions of the layer

out_dim:
    Output edge feature dimensions of the layer

in_dim_edges:
    input edge-feature dimensions of the layer

out_dim_edges:
    output edge-feature dimensions of the layer

activation:
    activation function to use in the layer

dropout:
    The ratio of units to dropout. Must be between 0 and 1

node_residual:
    If node residual is used after on the gnn layer output

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

mpnn_type:
    type of mpnn used, choose from "pyg:gin", "pyg:gine", "pyg:gated-gcn", "pyg:pna-msgpass" and "pyg:mpnnplus"

mpnn_kwargs:
    kwargs for mpnn layer

attn_type:
    type of attention used, choose from "full-attention" and "none"

attn_kwargs:
    kwargs for attention layer

droppath_rate_attn:
    stochastic depth drop rate for attention layer https://arxiv.org/abs/1603.09382

droppath_rate_ffn:
    stochastic depth drop rate for ffn layer https://arxiv.org/abs/1603.09382

mpnn_type:
    Type of MPNN layer to use. Choices specified in PYG_LAYERS_DICT

mpnn_kwargs:
    Keyword arguments to pass to the MPNN layer

attn_type:
    Type of attention layer to use. Choices specified in ATTENTION_LAYERS_DICT

biased_attention_key:
    indicates if biased attention is used by specifying a key corresponding to the pyg attribute in the batch (processed by the gaussian kernel encoder)
    default: None means biased attention is not used

attn_kwargs:
    Keyword arguments to pass to the attention layer

output_scale:
    Float value that will be used to scale the activations, helps reduce growth of activations

    as the model gets deeper. Default value of 1.0 leaves the layer unchanged.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>forward function of the layer
Parameters:
    batch: pyg Batch graphs to pass through the layer
Returns:
    batch: pyg Batch graphs</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_supports_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_supports_edges</span><span class="p">()</span></code>

<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.layer_supports_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type supports edges or not.</p>
<p>Returns:</p>
<pre><code>supports_edges: bool
    Always ``True`` for the current class
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.residual_add" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">residual_add</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">input_feature</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.residual_add" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Residual additition layer. Allows information to propagate through the model
by skipping the computational layers.
Parameters:
    feature: The feature (typically nodes or edges) after message passing
    input_feature: The same feature from before message passing
Returns:
    The addition of the two tensors.</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.scale_activations" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">scale_activations</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gps_pyg.GPSLayerPyg.scale_activations" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Scale Activations by a constant factor to stop growth of activation scale
and reduce numerical stability issues at low precision</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>feature</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The feature to scale</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scale_factor</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The floating point scale factor</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Tensor</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scaled features</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="gin-and-gine-layers">GIN and GINE Layers<a class="headerlink" href="#gin-and-gine-layers" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">




<h3 id="graphium.nn.pyg_layers.gin_pyg" class="doc doc-heading">
          <code>graphium.nn.pyg_layers.gin_pyg</code>


<a href="#graphium.nn.pyg_layers.gin_pyg" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.gin_pyg.GINConvPyg" class="doc doc-heading">
          <code>GINConvPyg</code>


<a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.nn.base_graph_layer.BaseGraphModule" href="graphium.nn.html#graphium.nn.base_graph_layer.BaseGraphModule">BaseGraphModule</a></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_inputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_inputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_inputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``False`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_outputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_outputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_outputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Abstract method. Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``False`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINConvPyg.out_dim_factor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim_factor</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.out_dim_factor" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the factor by which the output dimension is multiplied for
the next layer.</p>
<p>For standard layers, this will return <code>1</code>.</p>
<p>But for others, such as <code>GatLayer</code>, the output is the concatenation
of the outputs from each head, so the out_dim gets multiplied by
the number of heads, and this function should return the number
of heads.</p>
<p>Returns:</p>
<pre><code>int:
    Always ``1`` for the current class
</code></pre>
  </div>

</div>




<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINConvPyg.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>GIN: Graph Isomorphism Networks
HOW POWERFUL ARE GRAPH NEURAL NETWORKS? (Keyulu Xu, Weihua Hu, Jure Leskovec and Stefanie Jegelka, ICLR 2019)
<a href="https://arxiv.org/pdf/1810.00826.pdf">https://arxiv.org/pdf/1810.00826.pdf</a></p>
<p>[!] code uses the pytorch-geometric implementation of GINConv</p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the layer

out_dim:
    Output feature dimensions of the layer

activation:
    activation function to use in the layer

dropout:
    The ratio of units to dropout. Must be between 0 and 1

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

init_eps :
    Initial :math:`\epsilon` value, default: ``0``.

learn_eps :
    If True, :math:`\epsilon` will be a learnable parameter.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINConvPyg.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>forward function of the layer
Parameters:
    batch: pyg Batch graphs to pass through the layer
Returns:
    batch: pyg Batch graphs</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_supports_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_supports_edges</span><span class="p">()</span></code>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINConvPyg.layer_supports_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type supports edges or not.</p>
<p>Returns:</p>
<pre><code>supports_edges: bool
    Always ``False`` for the current class
</code></pre>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.gin_pyg.GINEConvPyg" class="doc doc-heading">
          <code>GINEConvPyg</code>


<a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.nn.base_graph_layer.BaseGraphModule" href="graphium.nn.html#graphium.nn.base_graph_layer.BaseGraphModule">BaseGraphModule</a></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_inputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_inputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_inputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``True`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_outputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_outputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_outputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Abstract method. Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``False`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.out_dim_factor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim_factor</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.out_dim_factor" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the factor by which the output dimension is multiplied for
the next layer.</p>
<p>For standard layers, this will return <code>1</code>.</p>
<p>But for others, such as <code>GatLayer</code>, the output is the concatenation
of the outputs from each head, so the out_dim gets multiplied by
the number of heads, and this function should return the number
of heads.</p>
<p>Returns:</p>
<pre><code>int:
    Always ``1`` for the current class
</code></pre>
  </div>

</div>




<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>GINE: Graph Isomorphism Networks with Edges
Strategies for Pre-training Graph Neural Networks
Weihua Hu, Bowen Liu, Joseph Gomes, Marinka Zitnik, Percy Liang, Vijay Pande, Jure Leskovec
<a href="https://arxiv.org/abs/1905.12265">https://arxiv.org/abs/1905.12265</a></p>
<p>[!] code uses the pytorch-geometric implementation of GINEConv</p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the layer

out_dim:
    Output feature dimensions of the layer

activation:
    activation function to use in the layer

dropout:
    The ratio of units to dropout. Must be between 0 and 1

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

init_eps :
    Initial :math:`\epsilon` value, default: ``0``.

learn_eps :
    If True, :math:`\epsilon` will be a learnable parameter.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>forward function of the layer
Parameters:
    batch: pyg Batch graphs to pass through the layer
Returns:
    batch: pyg Batch graphs</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_supports_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_supports_edges</span><span class="p">()</span></code>

<a href="#graphium.nn.pyg_layers.gin_pyg.GINEConvPyg.layer_supports_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type supports edges or not.</p>
<p>Returns:</p>
<pre><code>supports_edges: bool
    Always ``True`` for the current class
</code></pre>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="mpnn-layer">MPNN Layer<a class="headerlink" href="#mpnn-layer" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">




<h3 id="graphium.nn.pyg_layers.mpnn_pyg" class="doc doc-heading">
          <code>graphium.nn.pyg_layers.mpnn_pyg</code>


<a href="#graphium.nn.pyg_layers.mpnn_pyg" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg" class="doc doc-heading">
          <code>MPNNPlusPyg</code>


<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.nn.base_graph_layer.BaseGraphModule" href="graphium.nn.html#graphium.nn.base_graph_layer.BaseGraphModule">BaseGraphModule</a></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_inputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_inputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_inputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``True`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_outputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_outputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_outputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Abstract method. Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``True`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.out_dim_factor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim_factor</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.out_dim_factor" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the factor by which the output dimension is multiplied for
the next layer.</p>
<p>For standard layers, this will return <code>1</code>.</p>
<p>But for others, such as <code>GatLayer</code>, the output is the concatenation
of the outputs from each head, so the out_dim gets multiplied by
the number of heads, and this function should return the number
of heads.</p>
<p>Returns:</p>
<pre><code>int:
    Always ``1`` for the current class
</code></pre>
  </div>

</div>




<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">out_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;gelu&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;layer_norm&#39;</span><span class="p">,</span> <span class="n">gather_from</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">scatter_to</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">node_combine_method</span><span class="o">=</span><span class="s1">&#39;concat&#39;</span><span class="p">,</span> <span class="n">num_node_mlp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mlp_expansion_ratio</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">use_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">out_dim_edges</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">aggregation_method</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">],</span> <span class="n">num_edge_mlp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">use_globals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edge_dropout_rate</span><span class="o">=</span><span class="mf">0.0035</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <pre><code>MPNNPlusPyg: InteractionNetwork layer witg edges and global feature, GPS++ type of GNN layer
GPS++: An Optimised Hybrid MPNN/Transformer for Molecular Property Prediction
Dominic Masters, Josef Dean, Kerstin Klaser, Zhiyi Li, Sam Maddrell-Mander, Adam Sanders,
Hatem Helal, Deniz Beker, Ladislav Rampek, Dominique Beaini
https://arxiv.org/abs/2212.02229
</code></pre>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the nodes

out_dim:
    Output feature dimensions of the nodes

activation:
    Activation function to use in the edge and node model

dropout:
    The ratio of units to dropout at the end within apply_norm_activation_dropout.

normalization:
    Normalization to use with the edge, node models and at the end
    within apply_norm_activation_dropout. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

gather_from:
    The method to gather features from. Could choose from:
    "senders", "receivers" and "both".

scatter_to:
    The method to scatter features to. Could choose from:
    "senders", "receivers" and "both".

node_combine_method:
    The method to combine the node features, Could choose from:
    "sum" and "concat".

aggregation_method:
    Methods for aggregating (scatter) messages built from node and edge features.
    Provide a list of `Aggregation` or strings.
    supported strings are:

    - "sum" / "add" (Default)
    - "mean"
    - "max"
    - "min"
    - "softmax"
    - "median"
    - "std"
    - "var"

num_node_mlp:
    Number of mlp layer used for node model

mlp_expansion_ratio:
    Expansion ratio for node and edge mlp

use_edges:
    If edge features are used

in_dim_edges:
    Input feature dimensions of the edges

out_dim_edges:
    Output feature dimensions of the edges

num_edge_mlp:
    Number of mlp layer used for edge model

edge_dropout_rate:
    dropout rate for the edges
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.aggregate_features" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">aggregate_features</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">senders</span><span class="p">,</span> <span class="n">receivers</span><span class="p">,</span> <span class="n">sender_features</span><span class="p">,</span> <span class="n">receiver_features</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.aggregate_features" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Function to aggregate (scatter) messages built from node and edge features.</p>
<p>Parameters:</p>
<pre><code>input_features:
    Edge features of the batch

senders:
    Senders of the edge_index of the batch

receivers:
    Receivers of the edge_index of the batch

sender_features:
    Senders features gathered from the gather_features function

receiver_features:
    Receiver features gathered from the gather_features function

size:
    size of the aggregation, equals to the total number of nodes
</code></pre>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Tensor</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Aggregated node features</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Forward function of the MPNN Plus layer
Parameters:
    batch:
        pyg Batch graph to pass through the layer
Returns:
    batch:
        pyg Batch graph with updated node and edge features</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.gather_features" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">gather_features</span><span class="p">(</span><span class="n">input_features</span><span class="p">,</span> <span class="n">senders</span><span class="p">,</span> <span class="n">receivers</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.gather_features" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Function to gather node features based on the senders and receivers of the edge indices.</p>
<p>Parameters:</p>
<pre><code>input_features:
    Node features of the batch

senders:
    Senders of the edge_index of the batch

receivers:
    Receivers of the edge_index of the batch
</code></pre>

<details class="output" open>
  <summary>Output</summary>
  <p>Gathered node features (sender and receiver) summed up or concatenated
Gathered sender features
Gathered receiver features</p>
</details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_supports_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_supports_edges</span><span class="p">()</span></code>

<a href="#graphium.nn.pyg_layers.mpnn_pyg.MPNNPlusPyg.layer_supports_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type supports edges or not.</p>
<p>Returns:</p>
<pre><code>supports_edges: bool
    Always ``True`` for the current class
</code></pre>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="pna-layer">PNA Layer<a class="headerlink" href="#pna-layer" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">




<h3 id="graphium.nn.pyg_layers.pna_pyg" class="doc doc-heading">
          <code>graphium.nn.pyg_layers.pna_pyg</code>


<a href="#graphium.nn.pyg_layers.pna_pyg" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg" class="doc doc-heading">
          <code>PNAMessagePassingPyg</code>


<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch_geometric.nn.conv.MessagePassing">MessagePassing</span></code>, <code><a class="autorefs autorefs-internal" title="graphium.nn.base_graph_layer.BaseGraphStructure" href="graphium.nn.html#graphium.nn.base_graph_layer.BaseGraphStructure">BaseGraphStructure</a></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_inputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_inputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_inputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Returns ``self.edge_features``
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_outputs_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_outputs_edges</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_outputs_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Abstract method. Return a boolean specifying if the layer type
uses edges as input or not.
It is different from <code>layer_supports_edges</code> since a layer that
supports edges can decide to not use them.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``False`` for the current class
</code></pre>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h5 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.out_dim_factor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">out_dim_factor</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.out_dim_factor" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the factor by which the output dimension is multiplied for
the next layer.</p>
<p>For standard layers, this will return <code>1</code>.</p>
<p>But for others, such as <code>GatLayer</code>, the output is the concatenation
of the outputs from each head, so the out_dim gets multiplied by
the number of heads, and this function should return the number
of heads.</p>
<p>Returns:</p>
<pre><code>int:
    Always ``1`` for the current class
</code></pre>
  </div>

</div>




<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">aggregators</span><span class="p">,</span> <span class="n">scalers</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">avg_d</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;log&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;lin&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span> <span class="n">last_activation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">posttrans_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pretrans_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Implementation of the message passing architecture of the PNA message passing layer,
previously known as <code>PNALayerComplex</code>. This layer applies an MLP as
pretransformation to the concatenation of <span class="arithmatex">\([h_u, h_v, e_{uv}]\)</span> to generate
the messages, with <span class="arithmatex">\(h_u\)</span> the node feature, <span class="arithmatex">\(h_v\)</span> the neighbour node features,
and <span class="arithmatex">\(e_{uv}\)</span> the edge feature between the nodes <span class="arithmatex">\(u\)</span> and <span class="arithmatex">\(v\)</span>.</p>
<p>After the pre-transformation, it aggregates the messages
multiple aggregators and scalers,
concatenates their results, then applies an MLP on the concatenated
features.</p>
<p>PNA: Principal Neighbourhood Aggregation
Gabriele Corso, Luca Cavalleri, Dominique Beaini, Pietro Lio, Petar Velickovic
<a href="https://arxiv.org/abs/2004.05718">https://arxiv.org/abs/2004.05718</a></p>
<p>[!] code adapted from pytorch-geometric implementation of PNAConv</p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the layer

out_dim:
    Output feature dimensions of the layer

aggregators:
    Set of aggregation function identifiers,
    e.g. "mean", "max", "min", "std", "sum", "var", "moment3".
    The results from all aggregators will be concatenated.

scalers:
    Set of scaling functions identifiers
    e.g. "identidy", "amplification", "attenuation"
    The results from all scalers will be concatenated

activation:
    activation function to use in the layer

dropout:
    The ratio of units to dropout. Must be between 0 and 1

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

avg_d:
    Average degree of nodes in the training set, used by scalers to normalize

last_activation:
    activation function to use in the last layer of the internal MLP

posttrans_layers:
    number of layers in the MLP transformation after the aggregation

pretrans_layers:
    number of layers in the transformation before the aggregation

in_dim_edges:
    size of the edge features. If 0, edges are ignored
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.aggregate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">aggregate</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">edge_index</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.aggregate" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>aggregate function</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>input features</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>index of the nodes</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>edge_index</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>edge index</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dim_size</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dimension size</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    out: aggregated features</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>forward function of the layer
Parameters:
    batch: pyg Batch graphs
Returns:
    batch: pyg Batch graphs</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_supports_edges" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">layer_supports_edges</span><span class="p">()</span></code>

<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.layer_supports_edges" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return a boolean specifying if the layer type supports edges or not.</p>
<p>Returns:</p>
<pre><code>bool:
    Always ``True`` for the current class
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.message" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">message</span><span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="n">x_j</span><span class="p">,</span> <span class="n">edge_feat</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pna_pyg.PNAMessagePassingPyg.message" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>message function</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_i</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>node features</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>x_j</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>neighbour node features</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>edge_feat</code></td>
          <td>
                <code><span title="torch_geometric.typing.OptTensor">OptTensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>edge features</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    feat: the message</p>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="pooling-layers">Pooling Layers<a class="headerlink" href="#pooling-layers" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">




<h3 id="graphium.nn.pyg_layers.pooling_pyg" class="doc doc-heading">
          <code>graphium.nn.pyg_layers.pooling_pyg</code>


<a href="#graphium.nn.pyg_layers.pooling_pyg" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.pooling_pyg.PoolingWrapperPyg" class="doc doc-heading">
          <code>PoolingWrapperPyg</code>


<a href="#graphium.nn.pyg_layers.pooling_pyg.PoolingWrapperPyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.utils.tensor.ModuleWrap" href="../graphium.utils.html#graphium.utils.tensor.ModuleWrap">ModuleWrap</a></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.pooling_pyg.PoolingWrapperPyg.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pooling_pyg.PoolingWrapperPyg.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>forward function
Parameters:
    g: the pyg batch graph
    feature: the node features
Returns:
    the pooled features</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg" class="doc doc-heading">
          <code>VirtualNodePyg</code>


<a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.Module">Module</span></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">,</span> <span class="n">in_dim_edges</span><span class="p">,</span> <span class="n">out_dim_edges</span><span class="p">,</span> <span class="n">vn_type</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">residual</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>The VirtualNode is a layer that pool the features of the graph,
applies a neural network layer on the pooled features,
then add the result back to the node features of every node.</p>
<p>Parameters:</p>
<pre><code>in_dim:
    Input feature dimensions of the virtual node layer.

out_dim:
    Output feature dimensions of the virtual node layer.

in_dim_edges:
    Input feature dimensions of the virtual node layer for the edges.

out_dim_edges:
    Output feature dimensions of the virtual node layer for the edges.

vn_type:
    The type of the virtual node. Choices are:

    - "none": No pooling
    - "sum": Sum all the nodes for each graph
    - "mean": Mean all the nodes for each graph
    - "logsum": Mean all the nodes then multiply by log(num_nodes) for each graph
    - "max": Max all the nodes for each graph
    - "min": Min all the nodes for each graph
    - "std": Standard deviation of all the nodes for each graph

activation:
    activation function to use in the neural network layer.

dropout:
    The ratio of units to dropout. Must be between 0 and 1

normalization:
    Normalization to use. Choices:

    - "none" or `None`: No normalization
    - "batch_norm": Batch normalization
    - "layer_norm": Layer normalization
    - `Callable`: Any callable function

bias:
    Whether to add a bias to the neural network

residual:
    Whether all virtual nodes should be connected together
    via a residual connection

use_edges:
    Boolean flag to select if edges are used in the global node
    aggregation and update of features
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">feat</span><span class="p">,</span> <span class="n">vn_feat</span><span class="p">,</span> <span class="n">edge_feat</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pooling_pyg.VirtualNodePyg.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Apply the virtual node layer.</p>
<p>Parameters:</p>
<pre><code>g:
    PyG Graphs or Batched graphs.

feat (torch.Tensor[..., N, Din]):
    Node feature tensor, before convolution.
    `N` is the number of nodes, `Din` is the input features

vn_feat (torch.Tensor[..., M, Din]):
    Graph feature of the previous virtual node, or `None`
    `M` is the number of graphs, `Din` is the input features.
    It is added to the result after the MLP, as a residual connection

edge_feat (torch.Tensor[..., E, Din]):
    Edge feature tensor, before convolution.
    `E` is the number of edges, `Din` is the input features
</code></pre>
<p>Returns:</p>
<pre><code>`feat = torch.Tensor[..., N, Dout]`:
    Node feature tensor, after convolution and residual.
    `N` is the number of nodes, `Dout` is the output features of the layer and residual

`vn_feat = torch.Tensor[..., M, Dout]`:
    Graph feature tensor to be used at the next virtual node, or `None`
    `M` is the number of graphs, `Dout` is the output features

`edge_feat = torch.Tensor[..., N, Dout]`:
    Edge feature tensor, after convolution and residual - if edges are used, otherwise returned unchanged.
    `N` is the number of edges, `Dout` is the output features of the layer and residual
</code></pre>

  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h4 id="graphium.nn.pyg_layers.pooling_pyg.parse_pooling_layer_pyg" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_pooling_layer_pyg</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">pooling</span><span class="p">,</span> <span class="n">feat_type</span><span class="o">=</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pooling_pyg.parse_pooling_layer_pyg" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Select the pooling layers from a list of strings, and put them
in a Module that concatenates their outputs.</p>
<p>Parameters:</p>
<pre><code>in_dim:
    The dimension at the input layer of the pooling

pooling:
    The list of pooling layers to use. The accepted strings are:

    - "none": No pooling
    - "sum": Sum all the nodes for each graph
    - "mean": Mean all the nodes for each graph
    - "logsum": Mean all the nodes then multiply by log(num_nodes) for each graph
    - "max": Max all the nodes for each graph
    - "min": Min all the nodes for each graph
    - "std": Standard deviation of all the nodes for each graph
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="graphium.nn.pyg_layers.pooling_pyg.scatter_logsum_pool" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">scatter_logsum_pool</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pooling_pyg.scatter_logsum_pool" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Apply pooling over the nodes in the graph using a mean aggregation,
but scaled by the log of the number of nodes. This gives the same
expressive power as the sum, but helps deal with graphs that are
significantly larger than others by using a logarithmic scale.</p>
<div class="arithmatex">\[r^{(i)} = \frac{\log N_i}{N_i}\sum_{k=1}^{N_i} x^{(i)}_k\]</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Node feature matrix
:math:<code>\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>batch</code></td>
          <td>
                <code><span title="torch.LongTensor">LongTensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Batch vector :math:<code>\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N</code>, which assigns each node to a specific example.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Batch-size :math:<code>B</code>.
Automatically calculated if not given. (default: :obj:<code>None</code>)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    the pooled features tensor</p>

  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="graphium.nn.pyg_layers.pooling_pyg.scatter_std_pool" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">scatter_std_pool</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.pooling_pyg.scatter_std_pool" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Returns batch-wise graph-level-outputs by taking the channel-wise
minimum across the node dimension, so that for a single graph
:math:<code>\mathcal{G}_i</code> its output is computed by</p>
<p>.. math::
    \mathbf{r}<em>i = \mathrm{max}</em>{n=1}^{N_i} \, \mathbf{x}_n</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Node feature matrix
:math:<code>\mathbf{X} \in \mathbb{R}^{(N_1 + \ldots + N_B) \times F}</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>batch</code></td>
          <td>
                <code><span title="torch.LongTensor">LongTensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Batch vector :math:<code>\mathbf{b} \in {\{ 0, \ldots,
B-1\}}^N</code>, which assigns each node to a specific example.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Batch-size :math:<code>B</code>.
Automatically calculated if not given. (default: :obj:<code>None</code>)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the pooled features tensor</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div><h2 id="utils">Utils<a class="headerlink" href="#utils" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">




<h3 id="graphium.nn.pyg_layers.utils" class="doc doc-heading">
          <code>graphium.nn.pyg_layers.utils</code>


<a href="#graphium.nn.pyg_layers.utils" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.utils.GaussianLayer" class="doc doc-heading">
          <code>GaussianLayer</code>


<a href="#graphium.nn.pyg_layers.utils.GaussianLayer" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.Module">Module</span></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.utils.GaussianLayer.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">num_kernels</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">in_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.utils.GaussianLayer.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <pre><code>Gaussian kernel function that applied on the all-to-all 3D distances.
</code></pre>
<p>Parameters:
    num_kernels:
        Number of gaussian kernel used.</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h4 id="graphium.nn.pyg_layers.utils.PreprocessPositions" class="doc doc-heading">
          <code>PreprocessPositions</code>


<a href="#graphium.nn.pyg_layers.utils.PreprocessPositions" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.Module">Module</span></code></p>

  
      <p>Compute 3D attention bias and 3D node features according to the 3D position information.</p>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.utils.PreprocessPositions.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">num_heads</span><span class="p">,</span> <span class="n">embed_dim</span><span class="p">,</span> <span class="n">num_kernel</span><span class="p">,</span> <span class="n">in_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;gelu&#39;</span><span class="p">,</span> <span class="n">first_normalization</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.utils.PreprocessPositions.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_heads</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of attention heads used in self-attention.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>embed_dim</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Hidden dimension of node features.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_kernel</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of gaussian kernels.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_layers</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of layers in the MLP.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>activation</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The activation function used in the MLP.</p>
            </div>
          </td>
          <td>
                <code>&#39;gelu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>first_normalization</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The normalization function used before the gaussian kernel.</p>
            </div>
          </td>
          <td>
                <code>&#39;none&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">




<h5 id="graphium.nn.pyg_layers.utils.PreprocessPositions.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">max_num_nodes_per_graph</span><span class="p">,</span> <span class="n">on_ipu</span><span class="p">,</span> <span class="n">positions_3d_key</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.utils.PreprocessPositions.forward" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  

<details class="inputs" open>
  <summary>Inputs</summary>
  <p>batch:
    Batch object.
max_num_nodes_per_graph:
    Maximum number of nodes per graph.
on_ipu:
    If model rus on IPU.
positions_3d_key:
    The key of the pyg graph object that contains the 3D positions.</p>
</details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h4 id="graphium.nn.pyg_layers.utils.triplets" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">triplets</span><span class="p">(</span><span class="n">edge_index</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">)</span></code>

<a href="#graphium.nn.pyg_layers.utils.triplets" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Generates triplets from the given edge indices.
    A triplet is defined as a path of length two,
    such that if node A is connected to node B,
    and node B is connected to node C, then there is a triplet (A, B, C).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>edge_index</code></td>
          <td>
                <code>LongTensor</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The edge indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_nodes</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of nodes.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>col</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sink node indices of edges from the edge indices.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>row</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The source node indices of edges from the edge indices.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>idx_i</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sink node indices of the triplets.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>idx_j</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The middle node indices of the triplets.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>idx_k</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The source node indices of the triplets.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>idx_kj</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The indices of edges those from the source node to the middle node.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>idx_ji</code></td>          <td>
                <code><span title="torch.Tensor">Tensor</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The indices of edges those from the middle node to the sink node.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2020 - 2023 datamol.io
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.expand"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../_assets/js/google-analytics.js"></script>
      
    
  </body>
</html>