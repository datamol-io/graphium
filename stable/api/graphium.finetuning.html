
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Graphium: Scaling molecular GNNs to infinity.">
      
      
      
        <link rel="canonical" href="https://github.com/datamol-io/graphium/stable/api/graphium.finetuning.html">
      
      
        <link rel="prev" href="graphium.ipu.html">
      
      
        <link rel="next" href="../tutorials/feature_processing/add_new_positional_encoding.html">
      
      
      <link rel="icon" href="../images/logo-mini-dark.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>graphium.finetuning - graphium</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../_assets/css/custom.css">
    
      <link rel="stylesheet" href="../_assets/css/custom-graphium.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#graphiumfinetuning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="graphium" class="md-header__button md-logo" aria-label="graphium" data-md-component="logo">
      
  <img src="../images/logo-mini-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            graphium
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              graphium.finetuning
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/datamol-io/graphium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    valence-discovery/graphium
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../baseline.html" class="md-tabs__link">
        
  
    
  
  Baseline

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="graphium.nn/graphium.nn.html" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorials/feature_processing/add_new_positional_encoding.html" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../design.html" class="md-tabs__link">
        
  
    
  
  Design

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../datasets.html" class="md-tabs__link">
        
  
    
  
  Datasets

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../pretrained_models.html" class="md-tabs__link">
        
  
    
  
  Pretrained Models

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../cli/reference.html" class="md-tabs__link">
          
  
  CLI

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contribute.html" class="md-tabs__link">
        
  
    
  
  Contribute

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../license.html" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="graphium" class="md-nav__button md-logo" aria-label="graphium" data-md-component="logo">
      
  <img src="../images/logo-mini-white.svg" alt="logo">

    </a>
    graphium
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/datamol-io/graphium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    valence-discovery/graphium
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../baseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Baseline
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    graphium.nn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            graphium.nn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn/graphium.nn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn/architectures.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn.architectures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn/encoders.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn.encoders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn/pyg_layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.nn.pyg_layers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.trainer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graphium.ipu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium.ipu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    graphium.finetuning
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="graphium.finetuning.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    graphium.finetuning
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning" class="md-nav__link">
    <span class="md-ellipsis">
      GraphFinetuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GraphFinetuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning.finetune_function" class="md-nav__link">
    <span class="md-ellipsis">
      finetune_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning.freeze_before_training" class="md-nav__link">
    <span class="md-ellipsis">
      freeze_before_training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning.freeze_module" class="md-nav__link">
    <span class="md-ellipsis">
      freeze_module
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      FullGraphFinetuningNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FullGraphFinetuningNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.set_max_num_nodes_edges_per_graph" class="md-nav__link">
    <span class="md-ellipsis">
      set_max_num_nodes_edges_per_graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.PretrainedModel" class="md-nav__link">
    <span class="md-ellipsis">
      PretrainedModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PretrainedModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.overwrite_with_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      overwrite_with_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FinetuningHead" class="md-nav__link">
    <span class="md-ellipsis">
      FinetuningHead
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FinetuningHead">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FinetuningHead.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FinetuningHead.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter" class="md-nav__link">
    <span class="md-ellipsis">
      Fingerprinter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fingerprinter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.get_fingerprints_for_batch" class="md-nav__link">
    <span class="md-ellipsis">
      get_fingerprints_for_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.get_fingerprints_for_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      get_fingerprints_for_dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.setup" class="md-nav__link">
    <span class="md-ellipsis">
      setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.teardown" class="md-nav__link">
    <span class="md-ellipsis">
      teardown
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    feature_processing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            feature_processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/feature_processing/add_new_positional_encoding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add new positional encoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/feature_processing/csv_to_parquet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert CSV to Parquet files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/feature_processing/timing_parallel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timing parallel processing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    gnn_layers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            gnn_layers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/gnn/add_new_gnn_layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating GNN layers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/gnn/making_gnn_networks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Making GNN Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/gnn/using_gnn_layers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using GNN layers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    model_training
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            model_training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/model_training/simple-molecular-model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building and training a simple model from configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/model_training/running-multitask-ipu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multitask Molecular Modelling with Graphium on the IPU
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../design.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pretrained_models.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pretrained Models
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CLI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            CLI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/reference.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Commands
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/graphium.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/graphium-train.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphium-train
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contribute.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning" class="md-nav__link">
    <span class="md-ellipsis">
      GraphFinetuning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GraphFinetuning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning.finetune_function" class="md-nav__link">
    <span class="md-ellipsis">
      finetune_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning.freeze_before_training" class="md-nav__link">
    <span class="md-ellipsis">
      freeze_before_training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning.GraphFinetuning.freeze_module" class="md-nav__link">
    <span class="md-ellipsis">
      freeze_module
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      FullGraphFinetuningNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FullGraphFinetuningNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.set_max_num_nodes_edges_per_graph" class="md-nav__link">
    <span class="md-ellipsis">
      set_max_num_nodes_edges_per_graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.PretrainedModel" class="md-nav__link">
    <span class="md-ellipsis">
      PretrainedModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PretrainedModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.overwrite_with_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      overwrite_with_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FinetuningHead" class="md-nav__link">
    <span class="md-ellipsis">
      FinetuningHead
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FinetuningHead">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FinetuningHead.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.finetuning_architecture.FinetuningHead.make_mup_base_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      make_mup_base_kwargs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter" class="md-nav__link">
    <span class="md-ellipsis">
      Fingerprinter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fingerprinter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.get_fingerprints_for_batch" class="md-nav__link">
    <span class="md-ellipsis">
      get_fingerprints_for_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.get_fingerprints_for_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      get_fingerprints_for_dataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.setup" class="md-nav__link">
    <span class="md-ellipsis">
      setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.finetuning.fingerprinting.Fingerprinter.teardown" class="md-nav__link">
    <span class="md-ellipsis">
      teardown
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="graphiumfinetuning">graphium.finetuning<a class="headerlink" href="#graphiumfinetuning" title="Permanent link">&para;</a></h1>
<p>Module for finetuning models and doing linear probing (fingerprinting).</p>


<div class="doc doc-object doc-class">



<h3 id="graphium.finetuning.finetuning.GraphFinetuning" class="doc doc-heading">
          <code>graphium.finetuning.finetuning.GraphFinetuning</code>


<a href="#graphium.finetuning.finetuning.GraphFinetuning" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="pytorch_lightning.callbacks.BaseFinetuning">BaseFinetuning</span></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning.GraphFinetuning.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">finetuning_module</span><span class="p">,</span> <span class="n">added_depth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unfreeze_pretrained_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epoch_unfreeze_all</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">train_bn</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning.GraphFinetuning.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Finetuning training callback that (un)freezes modules as specified in the configuration file.
By default, the modified layers of the fineuning module and the finetuning head are unfrozen.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>finetuning_module</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Module to finetune from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>added_depth</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of layers of finetuning module that have been modified rel. to pretrained model</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>unfreeze_pretrained_depth</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of additional layers to unfreeze before layers modified rel. to pretrained model</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>epoch_unfreeze_all</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Epoch to unfreeze entire model</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>train_bn</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Boolean value indicating if batchnorm layers stay in training mode</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning.GraphFinetuning.finetune_function" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">finetune_function</span><span class="p">(</span><span class="n">pl_module</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning.GraphFinetuning.finetune_function" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Function unfreezing entire model at specified epoch</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pl_module</code></td>
          <td>
                <code><span title="pytorch_lightning.LightningModule">LightningModule</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PredictorModule used for finetuning</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>epoch</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Current training epoch</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>optimizer</code></td>
          <td>
                <code><span title="torch.optim.optimizer.Optimizer">Optimizer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optimizer used for finetuning</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning.GraphFinetuning.freeze_before_training" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">freeze_before_training</span><span class="p">(</span><span class="n">pl_module</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning.GraphFinetuning.freeze_before_training" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Freeze everything up to finetuning module (and parts of finetuning module)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pl_module</code></td>
          <td>
                <code><span title="pytorch_lightning.LightningModule">LightningModule</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PredictorModule used for finetuning</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning.GraphFinetuning.freeze_module" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">freeze_module</span><span class="p">(</span><span class="n">pl_module</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">module_map</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning.GraphFinetuning.freeze_module" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Freeze specific modules</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>module_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of module to (partally) freeze</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>module_map</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[<span title="torch.ModuleList">ModuleList</span>, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary mapping from module_name to corresponding module(s)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork" class="doc doc-heading">
          <code>graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork</code>


<a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.Module">Module</span></code>, <code><span title="graphium.nn.utils.MupMixin">MupMixin</span></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">pretrained_model</span><span class="p">,</span> <span class="n">pretrained_model_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">pretrained_overwriting_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">finetuning_head_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_inference_to_average</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">last_layer_is_readout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;FullFinetuningGNN&#39;</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Flexible class that allows to implement an end-to-end graph finetuning network architecture, supporting flexible pretrained models and finetuning heads.
The network decomposes into two parts of class PretrainedModel and FinetuningHead. The PretrainedModel class allows basic finetuning such as
finetuning from a specified module of the pretrained model and dropping/adding layers in this module. The (optional) FinetuningHead class allows more
flexible finetuning with a custom network applied after the pretrained model. If not specified, we fall back to basic finetuning integrated in PretrainedModel.</p>
<p>Parameters:</p>
<pre><code>pretrained_model:
    A PretrainedModel or an identifier of pretrained model within GRAPHIUM_PRETRAINED_MODELS_DICT or a valid .ckpt checkpoint path

pretrained_model_kwargs:
    Key-word arguments to instantiate a model of the same class as the pretrained model (e.g., FullGraphMultitaskNetwork))

pretrained_overwriting_kwargs:
    Key-word arguments indicating which parameters of loaded model are shared with the pretrained part of FullGraphFinetuningNetwork

finetuning_head_kwargs:
    Key-word arguments to use for the finetuning head.
    It must respect the following criteria:
    - pretrained_model_kwargs[last_used_module]["out_level"] must be equal to finetuning_head_kwargs["in_level"]
    - pretrained_model_kwargs[last_used_module]["out_dim"] must be equal to finetuning_head_kwargs["in_dim"]

    Here, [last_used_module] represents the module that is finetuned from,
    e.g., gnn, graph_output or (one of the) task_heads

num_inference_to_average:
    Number of inferences to average at val/test time. This is used to avoid the noise introduced
    by positional encodings with sign-flips. In case no such encoding is given,
    this parameter is ignored.
    NOTE: The inference time will be slowed-down proportionaly to this parameter.

last_layer_is_readout: Whether the last layer should be treated as a readout layer.
    Allows to use the `mup.MuReadout` from the muTransfer method https://github.com/microsoft/mup

name:
    Name attributed to the current network, for display and printing
    purposes.
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.forward" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">g</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.forward" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Apply the pre-processing neural network, the graph neural network,
and the post-processing neural network on the graph features.</p>
<p>Parameters:</p>
<pre><code>g:
    pyg Batch graph on which the convolution is done.
    Must contain the following elements:

    - Node key `"feat"`: `torch.Tensor[..., N, Din]`.
      Input node feature tensor, before the network.
      `N` is the number of nodes, `Din` is the input features dimension ``self.pre_nn.in_dim``

    - Edge key `"edge_feat"`: `torch.Tensor[..., N, Ein]` **Optional**.
      The edge features to use. It will be ignored if the
      model doesn't supporte edge features or if
      `self.in_dim_edges==0`.

    - Other keys related to positional encodings `"pos_enc_feats_sign_flip"`,
      `"pos_enc_feats_no_flip"`.
</code></pre>
<p>Returns:</p>
<pre><code>`torch.Tensor[..., M, Dout]` or `torch.Tensor[..., N, Dout]`:
    Node or graph feature tensor, after the network.
    `N` is the number of nodes, `M` is the number of graphs,
    `Dout` is the output dimension ``self.graph_output_nn.out_dim``
    If the `self.gnn.pooling` is [`None`], then it returns node features and the output dimension is `N`,
    otherwise it returns graph features and the output dimension is `M`
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.</p>
</details>


  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the kwargs to create the base model.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.set_max_num_nodes_edges_per_graph" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_max_num_nodes_edges_per_graph</span><span class="p">(</span><span class="n">max_nodes</span><span class="p">,</span> <span class="n">max_edges</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.FullGraphFinetuningNetwork.set_max_num_nodes_edges_per_graph" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Set the maximum number of nodes and edges for all gnn layers and encoder layers</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>max_nodes</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of nodes in the dataset.
This will be useful for certain architecture, but ignored by others.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_edges</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of edges in the dataset.
This will be useful for certain architecture, but ignored by others.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="graphium.finetuning.finetuning_architecture.PretrainedModel" class="doc doc-heading">
          <code>graphium.finetuning.finetuning_architecture.PretrainedModel</code>


<a href="#graphium.finetuning.finetuning_architecture.PretrainedModel" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.Module">Module</span></code>, <code><span title="graphium.nn.utils.MupMixin">MupMixin</span></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.PretrainedModel.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">pretrained_model</span><span class="p">,</span> <span class="n">pretrained_model_kwargs</span><span class="p">,</span> <span class="n">pretrained_overwriting_kwargs</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Flexible class allowing to finetune pretrained models from GRAPHIUM_PRETRAINED_MODELS_DICT or from a ckeckpoint path.
Can be any model that inherits from nn.Module, MupMixin and comes with a module map (e.g., FullGraphMultitaskNetwork)</p>
<p>Parameters:</p>
<pre><code>pretrained_model:
    Identifier of pretrained model within GRAPHIUM_PRETRAINED_MODELS_DICT or from a checkpoint path

pretrained_model_kwargs:
    Key-word arguments to instantiate a model of the same class as the pretrained model (e.g., FullGraphMultitaskNetwork))

pretrained_overwriting_kwargs:
    Key-word arguments indicating which parameters of loaded model are shared with the pretrained part of FullGraphFinetuningNetwork
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.PretrainedModel.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.
factor_in_dim: Whether to factor the input dimension</p>
</details>


  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the kwargs to create the base model.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.PretrainedModel.overwrite_with_pretrained" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">overwrite_with_pretrained</span><span class="p">(</span><span class="n">pretrained_model</span><span class="p">,</span> <span class="n">finetuning_module</span><span class="p">,</span> <span class="n">added_depth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sub_module_from_pretrained</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.PretrainedModel.overwrite_with_pretrained" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Overwrite parameters shared between loaded and modified pretrained model</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pretrained_model</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model from GRAPHIUM_PRETRAINED_MODELS_DICT</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>finetuning_module</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Module to finetune from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>added_depth</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of modified layers at the end of finetuning module</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>sub_module_from_pretrained</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional submodule to finetune from</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="graphium.finetuning.finetuning_architecture.FinetuningHead" class="doc doc-heading">
          <code>graphium.finetuning.finetuning_architecture.FinetuningHead</code>


<a href="#graphium.finetuning.finetuning_architecture.FinetuningHead" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="torch.Module">Module</span></code>, <code><span title="graphium.nn.utils.MupMixin">MupMixin</span></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.FinetuningHead.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">finetuning_head_kwargs</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.FinetuningHead.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Flexible class allowing to use a custom finetuning head on top of the pretrained model.
Can be any model that inherits from nn.Module, MupMixin.</p>
<p>Parameters:</p>
<pre><code>finetuning_head_kwargs: Key-word arguments needed to instantiate a custom (or existing) finetuning head from FINETUNING_HEADS_DICT
</code></pre>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.finetuning_architecture.FinetuningHead.make_mup_base_kwargs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_mup_base_kwargs</span><span class="p">(</span><span class="n">divide_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">factor_in_dim</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.finetuning.finetuning_architecture.FinetuningHead.make_mup_base_kwargs" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create a 'base' model to be used by the <code>mup</code> or <code>muTransfer</code> scaling of the model.
The base model is usually identical to the regular model, but with the
layers width divided by a given factor (2 by default)</p>

<details class="parameter" open>
  <summary>Parameter</summary>
  <p>divide_factor: Factor by which to divide the width.
factor_in_dim: Whether to factor the input dimension</p>
</details>


  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary with the kwargs to create the base model.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="graphium.finetuning.fingerprinting.Fingerprinter" class="doc doc-heading">
          <code>graphium.finetuning.fingerprinting.Fingerprinter</code>


<a href="#graphium.finetuning.fingerprinting.Fingerprinter" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents first">

  
      <p>Extract fingerprints from a <a class="autorefs autorefs-internal" href="graphium.nn/architectures.html#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork"><code>FullGraphMultiTaskNetwork</code></a></p>
<p>Fingerprints are hidden representations of a pre-trained network.
They can be used as an additional representation for task-specific ML models
in downstream tasks.</p>

<details class="info" open>
  <summary>Connection to linear probing.</summary>
  <p>This two-stage process is similar in concept to linear-probing,
but pre-computing the fingerprints further decouples the two stages
and allows for more flexibility.</p>
</details>
<details class="note" open>
  <summary>CLI support</summary>
  <p>You can extract fingerprints easily with the CLI. For more info, see
<div class="highlight"><pre><span></span><code>graphium<span class="w"> </span>finetune<span class="w"> </span>fingerprint<span class="w"> </span>--help
</code></pre></div></p>
</details>      <p>To return intermediate representations, the network will be altered
to save the readouts of the specified layers. This class is designed to be used
as a context manager that automatically reverts the network to its original state.</p>
<p>Examples:</p>
<pre><code>Basic usage:
```python
# Return layer 1 of the gcn submodule.
# For a full list of options, see the `_module_map` attribute of the FullGraphMultiTaskNetwork.
fp_spec = "gcn:1"

# Create the object
fingerprinter = Fingerprinter(predictor, "gcn:1")

# Setup, run and teardown the fingerprinting process
fingerprinter.setup()
fp = fp.get_fingerprints_for_batch(batch)
fingerprinter.teardown()
```

As context manager:
```python
with Fingerprinter(predictor, "gcn:1") as fingerprinter:
    fp = fp.get_fingerprints_for_batch(batch)
```

Concatenating multiple hidden representations:
```python
with Fingerprinter(predictor, ["gcn:0", "gcn:1"]) as fingerprinter:
    fp = fp.get_fingerprints_for_batch(batch)
```

For an entire dataset (expects a PyG dataloader):
```python
with Fingerprinter(predictor, ["gcn:0", "gcn:1"]) as fingerprinter:
    fps = fp.get_fingerprints_for_dataset(dataloader)
```

Returning numpy arrays instead of torch tensors:
```python
with Fingerprinter(predictor, ["gcn:0", "gcn:1"], out_type="numpy") as fingerprinter:
    fps = fp.get_fingerprints_for_dataset(dataloader)
```
</code></pre>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.fingerprinting.Fingerprinter.__enter__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__enter__</span><span class="p">()</span></code>

<a href="#graphium.finetuning.fingerprinting.Fingerprinter.__enter__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Setup the network for fingerprinting</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.fingerprinting.Fingerprinter.__exit__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__exit__</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span></code>

<a href="#graphium.finetuning.fingerprinting.Fingerprinter.__exit__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Revert the network to its original state</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.fingerprinting.Fingerprinter.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fingerprint_spec</span><span class="p">,</span> <span class="n">out_type</span><span class="o">=</span><span class="s1">&#39;torch&#39;</span><span class="p">)</span></code>

<a href="#graphium.finetuning.fingerprinting.Fingerprinter.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork" href="graphium.nn/architectures.html#graphium.nn.architectures.global_architectures.FullGraphMultiTaskNetwork">FullGraphMultiTaskNetwork</a>, <a class="autorefs autorefs-internal" title="graphium.trainer.predictor.PredictorModule" href="graphium.trainer.html#graphium.trainer.predictor.PredictorModule">PredictorModule</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Either a <code>FullGraphMultiTaskNetwork</code> or a <code>PredictorModule</code> that contains one. The benefit
of using a <code>PredictorModule</code> is that it will automatically convert the features to the correct dtype.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fingerprint_spec</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The fingerprint specification. Of the format <code>module:layer</code>. If specified as a list,
the fingerprints from all the specified layers will be concatenated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>out_type</code></td>
          <td>
                <code><span title="typing.Literal">Literal</span>[&#39;torch&#39;, &#39;numpy&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output type of the fingerprints. Either <code>torch</code> or <code>numpy</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;torch&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.fingerprinting.Fingerprinter.get_fingerprints_for_batch" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_fingerprints_for_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#graphium.finetuning.fingerprinting.Fingerprinter.get_fingerprints_for_batch" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Get the fingerprints for a single batch</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.fingerprinting.Fingerprinter.get_fingerprints_for_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_fingerprints_for_dataset</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span></code>

<a href="#graphium.finetuning.fingerprinting.Fingerprinter.get_fingerprints_for_dataset" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return the fingerprints for an entire dataset</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.fingerprinting.Fingerprinter.setup" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">setup</span><span class="p">()</span></code>

<a href="#graphium.finetuning.fingerprinting.Fingerprinter.setup" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Prepare the network for fingerprinting</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.finetuning.fingerprinting.Fingerprinter.teardown" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">teardown</span><span class="p">()</span></code>

<a href="#graphium.finetuning.fingerprinting.Fingerprinter.teardown" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Restore the network to its original state</p>

  </div>

</div>



  </div>

  </div>


</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2020 - 2023 datamol.io
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.expand"], "search": "../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../_assets/js/google-analytics.js"></script>
      
    
  </body>
</html>