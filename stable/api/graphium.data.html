
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Graphium: Scaling molecular GNNs to infinity.">
      
      
      
        <link rel="canonical" href="https://github.com/datamol-io/graphium/stable/api/graphium.data.html">
      
      
        <link rel="prev" href="graphium.trainer.html">
      
      
        <link rel="next" href="graphium.utils.html">
      
      <link rel="icon" href="../images/logo.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>graphium.data - graphium</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../_assets/css/custom.css">
    
      <link rel="stylesheet" href="../_assets/css/custom-graphium.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#graphiumdata" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="graphium" class="md-header__button md-logo" aria-label="graphium" data-md-component="logo">
      
  <img src="../images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            graphium
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              graphium.data
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/datamol-io/graphium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    valence-discovery/graphium
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../index.html" class="md-tabs__link">
      Overview
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../baseline.html" class="md-tabs__link">
      Baseline
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="graphium.nn/graphium.nn.html" class="md-tabs__link md-tabs__link--active">
        API
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../tutorials/feature_processing/add_new_positional_encoding.html" class="md-tabs__link">
        Tutorials
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../design.html" class="md-tabs__link">
      Design
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../datasets.html" class="md-tabs__link">
      Datasets
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../pretrained_models.html" class="md-tabs__link">
      Pretrained Models
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../contribute.html" class="md-tabs__link">
      Contribute
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../license.html" class="md-tabs__link">
      License
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../cli_references.html" class="md-tabs__link">
      CLI
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="graphium" class="md-nav__button md-logo" aria-label="graphium" data-md-component="logo">
      
  <img src="../images/logo.svg" alt="logo">

    </a>
    graphium
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/datamol-io/graphium" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    valence-discovery/graphium
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../baseline.html" class="md-nav__link">
        Baseline
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          graphium.nn
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          graphium.nn
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn/graphium.nn.html" class="md-nav__link">
        graphium.nn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn/architectures.html" class="md-nav__link">
        graphium.nn.architectures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn/encoders.html" class="md-nav__link">
        graphium.nn.encoders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.nn/pyg_layers.html" class="md-nav__link">
        graphium.nn.pyg_layers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.features.html" class="md-nav__link">
        graphium.features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.trainer.html" class="md-nav__link">
        graphium.trainer
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          graphium.data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="graphium.data.html" class="md-nav__link md-nav__link--active">
        graphium.data
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-module" class="md-nav__link">
    Data Module
  </a>
  
    <nav class="md-nav" aria-label="Data Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule" class="md-nav__link">
    datamodule
  </a>
  
    <nav class="md-nav" aria-label="datamodule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.ADMETBenchmarkDataModule" class="md-nav__link">
    ADMETBenchmarkDataModule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule" class="md-nav__link">
    BaseDataModule
  </a>
  
    <nav class="md-nav" aria-label="BaseDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_num_workers" class="md-nav__link">
    get_num_workers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.predict_ds" class="md-nav__link">
    predict_ds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_dataloader" class="md-nav__link">
    get_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_dataloader_kwargs" class="md-nav__link">
    get_dataloader_kwargs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_max_num_edges_datamodule" class="md-nav__link">
    get_max_num_edges_datamodule()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_max_num_nodes_datamodule" class="md-nav__link">
    get_max_num_nodes_datamodule()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.predict_dataloader" class="md-nav__link">
    predict_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.test_dataloader" class="md-nav__link">
    test_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.train_dataloader" class="md-nav__link">
    train_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.val_dataloader" class="md-nav__link">
    val_dataloader()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.DatasetProcessingParams" class="md-nav__link">
    DatasetProcessingParams
  </a>
  
    <nav class="md-nav" aria-label="DatasetProcessingParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.DatasetProcessingParams.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule" class="md-nav__link">
    FakeDataModule
  </a>
  
    <nav class="md-nav" aria-label="FakeDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule.generate_data" class="md-nav__link">
    generate_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule.get_fake_graph" class="md-nav__link">
    get_fake_graph()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule.prepare_data" class="md-nav__link">
    prepare_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.GraphOGBDataModule" class="md-nav__link">
    GraphOGBDataModule
  </a>
  
    <nav class="md-nav" aria-label="GraphOGBDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.GraphOGBDataModule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.GraphOGBDataModule.to_dict" class="md-nav__link">
    to_dict()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.IPUDataModuleModifier" class="md-nav__link">
    IPUDataModuleModifier
  </a>
  
    <nav class="md-nav" aria-label="IPUDataModuleModifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.IPUDataModuleModifier.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule" class="md-nav__link">
    MultitaskFromSmilesDataModule
  </a>
  
    <nav class="md-nav" aria-label="MultitaskFromSmilesDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.in_dims" class="md-nav__link">
    in_dims
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.num_edge_feats" class="md-nav__link">
    num_edge_feats
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.num_node_feats" class="md-nav__link">
    num_node_feats
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.calculate_statistics" class="md-nav__link">
    calculate_statistics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_data_cache_fullname" class="md-nav__link">
    get_data_cache_fullname()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_data_hash" class="md-nav__link">
    get_data_hash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_dataloader" class="md-nav__link">
    get_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_dataloader_kwargs" class="md-nav__link">
    get_dataloader_kwargs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_fake_graph" class="md-nav__link">
    get_fake_graph()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_label_statistics" class="md-nav__link">
    get_label_statistics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_subsets_of_datasets" class="md-nav__link">
    get_subsets_of_datasets()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.load_data_from_cache" class="md-nav__link">
    load_data_from_cache()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.normalize_label" class="md-nav__link">
    normalize_label()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.prepare_data" class="md-nav__link">
    prepare_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.to_dict" class="md-nav__link">
    to_dict()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collate-module" class="md-nav__link">
    Collate Module
  </a>
  
    <nav class="md-nav" aria-label="Collate Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate" class="md-nav__link">
    collate
  </a>
  
    <nav class="md-nav" aria-label="collate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.collage_pyg_graph" class="md-nav__link">
    collage_pyg_graph()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.collate_labels" class="md-nav__link">
    collate_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.collate_pyg_graph_labels" class="md-nav__link">
    collate_pyg_graph_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.get_expected_label_size" class="md-nav__link">
    get_expected_label_size()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.graphium_collate_fn" class="md-nav__link">
    graphium_collate_fn()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.pad_nodepairs" class="md-nav__link">
    pad_nodepairs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.pad_to_expected_label_size" class="md-nav__link">
    pad_to_expected_label_size()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#util-functions" class="md-nav__link">
    Util Functions
  </a>
  
    <nav class="md-nav" aria-label="Util Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.download_graphium_dataset" class="md-nav__link">
    download_graphium_dataset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.found_size_mismatch" class="md-nav__link">
    found_size_mismatch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.graphium_package_path" class="md-nav__link">
    graphium_package_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.list_graphium_datasets" class="md-nav__link">
    list_graphium_datasets()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.load_micro_zinc" class="md-nav__link">
    load_micro_zinc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.load_tiny_zinc" class="md-nav__link">
    load_tiny_zinc()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.utils.html" class="md-nav__link">
        graphium.utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.config.html" class="md-nav__link">
        graphium.config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.ipu.html" class="md-nav__link">
        graphium.ipu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphium.visualization.html" class="md-nav__link">
        graphium.visualization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          feature_processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          feature_processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/feature_processing/add_new_positional_encoding.html" class="md-nav__link">
        Add new positional encoding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/feature_processing/csv_to_parquet.html" class="md-nav__link">
        Convert CSV to Parquet files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/feature_processing/timing_parallel.html" class="md-nav__link">
        Timing parallel processing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          gnn_layers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          gnn_layers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/gnn/add_new_gnn_layers.html" class="md-nav__link">
        Creating GNN layers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/gnn/making_gnn_networks.html" class="md-nav__link">
        Making GNN Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/gnn/using_gnn_layers.html" class="md-nav__link">
        Using GNN layers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          model_training
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          model_training
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/model_training/simple-molecular-model.html" class="md-nav__link">
        Building and training a simple model from configurations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/model_training/running-multitask-ipu.html" class="md-nav__link">
        Multitask Molecular Modelling with Graphium on the IPU
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../design.html" class="md-nav__link">
        Design
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../datasets.html" class="md-nav__link">
        Datasets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pretrained_models.html" class="md-nav__link">
        Pretrained Models
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute.html" class="md-nav__link">
        Contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license.html" class="md-nav__link">
        License
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cli_references.html" class="md-nav__link">
        CLI
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-module" class="md-nav__link">
    Data Module
  </a>
  
    <nav class="md-nav" aria-label="Data Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule" class="md-nav__link">
    datamodule
  </a>
  
    <nav class="md-nav" aria-label="datamodule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.ADMETBenchmarkDataModule" class="md-nav__link">
    ADMETBenchmarkDataModule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule" class="md-nav__link">
    BaseDataModule
  </a>
  
    <nav class="md-nav" aria-label="BaseDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_num_workers" class="md-nav__link">
    get_num_workers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.predict_ds" class="md-nav__link">
    predict_ds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_dataloader" class="md-nav__link">
    get_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_dataloader_kwargs" class="md-nav__link">
    get_dataloader_kwargs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_max_num_edges_datamodule" class="md-nav__link">
    get_max_num_edges_datamodule()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.get_max_num_nodes_datamodule" class="md-nav__link">
    get_max_num_nodes_datamodule()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.predict_dataloader" class="md-nav__link">
    predict_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.test_dataloader" class="md-nav__link">
    test_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.train_dataloader" class="md-nav__link">
    train_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.BaseDataModule.val_dataloader" class="md-nav__link">
    val_dataloader()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.DatasetProcessingParams" class="md-nav__link">
    DatasetProcessingParams
  </a>
  
    <nav class="md-nav" aria-label="DatasetProcessingParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.DatasetProcessingParams.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule" class="md-nav__link">
    FakeDataModule
  </a>
  
    <nav class="md-nav" aria-label="FakeDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule.generate_data" class="md-nav__link">
    generate_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule.get_fake_graph" class="md-nav__link">
    get_fake_graph()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule.prepare_data" class="md-nav__link">
    prepare_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.FakeDataModule.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.GraphOGBDataModule" class="md-nav__link">
    GraphOGBDataModule
  </a>
  
    <nav class="md-nav" aria-label="GraphOGBDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.GraphOGBDataModule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.GraphOGBDataModule.to_dict" class="md-nav__link">
    to_dict()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.IPUDataModuleModifier" class="md-nav__link">
    IPUDataModuleModifier
  </a>
  
    <nav class="md-nav" aria-label="IPUDataModuleModifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.IPUDataModuleModifier.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule" class="md-nav__link">
    MultitaskFromSmilesDataModule
  </a>
  
    <nav class="md-nav" aria-label="MultitaskFromSmilesDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.in_dims" class="md-nav__link">
    in_dims
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.num_edge_feats" class="md-nav__link">
    num_edge_feats
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.num_node_feats" class="md-nav__link">
    num_node_feats
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.calculate_statistics" class="md-nav__link">
    calculate_statistics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_data_cache_fullname" class="md-nav__link">
    get_data_cache_fullname()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_data_hash" class="md-nav__link">
    get_data_hash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_dataloader" class="md-nav__link">
    get_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_dataloader_kwargs" class="md-nav__link">
    get_dataloader_kwargs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_fake_graph" class="md-nav__link">
    get_fake_graph()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_label_statistics" class="md-nav__link">
    get_label_statistics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_subsets_of_datasets" class="md-nav__link">
    get_subsets_of_datasets()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.load_data_from_cache" class="md-nav__link">
    load_data_from_cache()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.normalize_label" class="md-nav__link">
    normalize_label()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.prepare_data" class="md-nav__link">
    prepare_data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.setup" class="md-nav__link">
    setup()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.to_dict" class="md-nav__link">
    to_dict()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collate-module" class="md-nav__link">
    Collate Module
  </a>
  
    <nav class="md-nav" aria-label="Collate Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate" class="md-nav__link">
    collate
  </a>
  
    <nav class="md-nav" aria-label="collate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.collage_pyg_graph" class="md-nav__link">
    collage_pyg_graph()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.collate_labels" class="md-nav__link">
    collate_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.collate_pyg_graph_labels" class="md-nav__link">
    collate_pyg_graph_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.get_expected_label_size" class="md-nav__link">
    get_expected_label_size()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.graphium_collate_fn" class="md-nav__link">
    graphium_collate_fn()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.pad_nodepairs" class="md-nav__link">
    pad_nodepairs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.collate.pad_to_expected_label_size" class="md-nav__link">
    pad_to_expected_label_size()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#util-functions" class="md-nav__link">
    Util Functions
  </a>
  
    <nav class="md-nav" aria-label="Util Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.download_graphium_dataset" class="md-nav__link">
    download_graphium_dataset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.found_size_mismatch" class="md-nav__link">
    found_size_mismatch()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.graphium_package_path" class="md-nav__link">
    graphium_package_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.list_graphium_datasets" class="md-nav__link">
    list_graphium_datasets()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.load_micro_zinc" class="md-nav__link">
    load_micro_zinc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphium.data.utils.load_tiny_zinc" class="md-nav__link">
    load_tiny_zinc()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="graphiumdata">graphium.data<a class="headerlink" href="#graphiumdata" title="Permanent link">&para;</a></h1>
<p>module for loading datasets and collating batches</p>
<div class="tabbed-set" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Contents</label><div class="tabbed-content">
<ul>
<li><a href="#data-module">Data Module</a></li>
<li><a href="#collate-module">Collate Module</a></li>
<li><a href="#util-functions">Util Functions</a></li>
</ul>
</div>
</div>
<h2 id="data-module">Data Module<a class="headerlink" href="#data-module" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">



<h3 id="graphium.data.datamodule" class="doc doc-heading">
            <code>graphium.data.datamodule</code>


<a href="#graphium.data.datamodule" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="graphium.data.datamodule.ADMETBenchmarkDataModule" class="doc doc-heading">
          <code>ADMETBenchmarkDataModule</code>


<a href="#graphium.data.datamodule.ADMETBenchmarkDataModule" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.data.datamodule.MultitaskFromSmilesDataModule" href="#graphium.data.datamodule.MultitaskFromSmilesDataModule">MultitaskFromSmilesDataModule</a></code></p>

  
      <p>Wrapper to use the ADMET benchmark group from the TDC (Therapeutics Data Commons).</p>
<div class="admonition warning">
<p class="admonition-title">Dependency</p>
<p>This class requires <a href="https://pypi.org/project/PyTDC/">PyTDC</a> to be installed.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Citation</p>
<p>Huang, K., Fu, T., Gao, W., Zhao, Y., Roohani, Y., Leskovec, J., Coley, C., Xiao, C., Sun, J., &amp; Zitnik, M. (2021).
Therapeutics Data Commons: Machine Learning Datasets and Tasks for Drug Discovery and Development.
Proceedings of Neural Information Processing Systems, NeurIPS Datasets and Benchmarks.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>tdc_benchmark_names</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, <span title="typing.List">List</span>[str]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This can be any subset of the benchmark names that make up the ADMET benchmarking group.
If <code>None</code>, uses the complete benchmarking group. For all full list of options, see
<a href="https://tdcommons.ai/benchmark/admet_group/overview/">the TDC website</a> or use:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">tdc.utils.retrieve_benchmark_names</span>
<span class="n">retrieve_benchmark_names</span><span class="p">(</span><span class="s2">&quot;admet_group&quot;</span><span class="p">)</span>
</code></pre></div>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>tdc_train_val_seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>TDC recommends a default splitting method for the train-val split. This parameter
is used to seed that splitting method.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.data.datamodule.BaseDataModule" class="doc doc-heading">
          <code>BaseDataModule</code>


<a href="#graphium.data.datamodule.BaseDataModule" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>lightning.<span title="lightning.LightningDataModule">LightningDataModule</span></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="graphium.data.datamodule.BaseDataModule.get_num_workers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_num_workers</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.data.datamodule.BaseDataModule.get_num_workers" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>get the number of workers to use</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.data.datamodule.BaseDataModule.predict_ds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_ds</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#graphium.data.datamodule.BaseDataModule.predict_ds" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the dataset used for the prediction</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">batch_size_training</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">batch_size_inference</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">batch_size_per_pack</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">persistent_workers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collate_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>base dataset module for all datasets (to be inherented)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>batch_size_training</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>batch size for training</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size_inference</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>batch size for inference</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr>
          <td><code>num_workers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>number of workers for data loading</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>pin_memory</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether to pin memory</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>persistent_workers</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether to use persistent workers</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>collate_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>collate function for batching</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.get_dataloader" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_dataloader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">shuffle</span><span class="p">,</span> <span class="n">stage</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.get_dataloader" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the dataloader for a given dataset</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dataset</code></td>
          <td>
                <code><span title="torch.utils.data.dataloader.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dataset from which to load the data</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shuffle</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>set to <code>True</code> to have the data reshuffled at every epoch.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stage</code></td>
          <td>
                <code><span title="lightning.pytorch.trainer.states.RunningStage">RunningStage</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether in Training, Validating, Testing, Sanity-checking, Predicting, or Tuning phase.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="torch.utils.data.dataloader.DataLoader">DataLoader</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dataloader to sample from</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.get_dataloader_kwargs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_dataloader_kwargs</span><span class="p">(</span><span class="n">stage</span><span class="p">,</span> <span class="n">shuffle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.get_dataloader_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the options for the dataloader depending on the current stage.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stage</code></td>
          <td>
                <code><span title="lightning.pytorch.trainer.states.RunningStage">RunningStage</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether in Training, Validating, Testing, Sanity-checking, Predicting, or Tuning phase.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shuffle</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>set to <code>True</code> to have the data reshuffled at every epoch.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arguments to pass to the <code>DataLoader</code> during initialization</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.get_max_num_edges_datamodule" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_max_num_edges_datamodule</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.get_max_num_edges_datamodule" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the maximum number of edges across all datasets from the datamodule</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>datamodule</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The datamodule from which to extract the maximum number of nodes</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stages</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The stages from which to extract the max num nodes.
Possible values are ["train", "val", "test", "predict"].
If None, all stages are considered.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>max_num_edges</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of edges across all datasets from the datamodule</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.get_max_num_nodes_datamodule" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_max_num_nodes_datamodule</span><span class="p">(</span><span class="n">stages</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.get_max_num_nodes_datamodule" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the maximum number of nodes across all datasets from the datamodule</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>datamodule</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The datamodule from which to extract the maximum number of nodes</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stages</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The stages from which to extract the max num nodes.
Possible values are ["train", "val", "test", "predict"].
If None, all stages are considered.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>max_num_nodes</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of nodes across all datasets from the datamodule</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.predict_dataloader" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_dataloader</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.predict_dataloader" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>return the dataloader for prediction</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.test_dataloader" class="doc doc-heading">
<code class="highlight language-python"><span class="n">test_dataloader</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.test_dataloader" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>return the test dataloader</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.train_dataloader" class="doc doc-heading">
<code class="highlight language-python"><span class="n">train_dataloader</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.train_dataloader" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>return the training dataloader</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.BaseDataModule.val_dataloader" class="doc doc-heading">
<code class="highlight language-python"><span class="n">val_dataloader</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.BaseDataModule.val_dataloader" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>return the validation dataloader</p>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.data.datamodule.DatasetProcessingParams" class="doc doc-heading">
          <code>DatasetProcessingParams</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#graphium.data.datamodule.DatasetProcessingParams" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.DatasetProcessingParams.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">task_level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">smiles_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idx_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mol_ids_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_val</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">split_test</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epoch_sampling_fraction</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">splits_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">split_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">label_normalization</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.DatasetProcessingParams.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>object to store the parameters for the dataset processing</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>task_level</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The task level, wether it is graph, node, edge or nodepair</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dataframe containing the data</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>df_path</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the dataframe containing the data</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>smiles_col</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The column name of the smiles</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>label_cols</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The column names of the labels</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>weights_col</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The column name of the weights</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>weights_type</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of weights</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>idx_col</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The column name of the indices</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>mol_ids_col</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The column name of the molecule ids</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sample_size</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[int, float, <span title="typing.Type">Type</span>[None]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the sample</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>split_val</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The fraction of the data to use for validation</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>split_test</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The fraction of the data to use for testing</p>
            </div>
          </td>
          <td>
                <code>0.2</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The seed to use for the splits and subsampling</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>splits_path</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the splits</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.data.datamodule.FakeDataModule" class="doc doc-heading">
          <code>FakeDataModule</code>


<a href="#graphium.data.datamodule.FakeDataModule" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.data.datamodule.MultitaskFromSmilesDataModule" href="#graphium.data.datamodule.MultitaskFromSmilesDataModule">MultitaskFromSmilesDataModule</a></code></p>

  
      <p>A fake datamodule that generates artificial data by mimicking the true data coming
from the provided dataset.
It is useful to test the speed and performance of the model on a dataset without
having to featurize it and wait for the workers to load it.</p>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.FakeDataModule.generate_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_data</span><span class="p">(</span><span class="n">label_cols</span><span class="p">,</span> <span class="n">smiles_col</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.FakeDataModule.generate_data" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pd.DataFrame</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.FakeDataModule.get_fake_graph" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_fake_graph</span><span class="p">()</span></code>

<a href="#graphium.data.datamodule.FakeDataModule.get_fake_graph" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Low memory footprint method to get the first datapoint DGL graph.
The first 10 rows of the data are read in case the first one has a featurization
error. If all 20 first element, then <code>None</code> is returned, otherwise the first
graph to not fail is returned.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.FakeDataModule.prepare_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prepare_data</span><span class="p">()</span></code>

<a href="#graphium.data.datamodule.FakeDataModule.prepare_data" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Called only from a single process in distributed settings. Steps:</p>
<ul>
<li>If each cache is set and exists, reload from cache and return. Otherwise,</li>
<li>For each single-task dataset:<ul>
<li>Load its dataframe from a path (if provided)</li>
<li>Subsample the dataframe</li>
<li>Extract the smiles, labels from the dataframe</li>
</ul>
</li>
<li>In the previous step, we were also able to get the unique smiles, which we use to compute the features</li>
<li>For each single-task dataframe and associated data (smiles, labels, etc.):<ul>
<li>Filter out the data corresponding to molecules which failed featurization.</li>
<li>Create a corresponding SingletaskDataset</li>
<li>Split the SingletaskDataset according to the task-specific splits for train, val and test</li>
</ul>
</li>
</ul>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.FakeDataModule.setup" class="doc doc-heading">
<code class="highlight language-python"><span class="n">setup</span><span class="p">(</span><span class="n">stage</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.FakeDataModule.setup" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Prepare the torch dataset. Called on every GPUs. Setting state here is ok.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stage</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Either 'fit', 'test', or None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.data.datamodule.GraphOGBDataModule" class="doc doc-heading">
          <code>GraphOGBDataModule</code>


<a href="#graphium.data.datamodule.GraphOGBDataModule" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.data.datamodule.MultitaskFromSmilesDataModule" href="#graphium.data.datamodule.MultitaskFromSmilesDataModule">MultitaskFromSmilesDataModule</a></code></p>



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.GraphOGBDataModule.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">task_specific_args</span><span class="p">,</span> <span class="n">processed_graph_data_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataloading_from</span><span class="o">=</span><span class="s1">&#39;ram&#39;</span><span class="p">,</span> <span class="n">featurization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size_training</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">batch_size_inference</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">batch_size_per_pack</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">persistent_workers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">featurization_n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">featurization_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">featurization_backend</span><span class="o">=</span><span class="s1">&#39;loky&#39;</span><span class="p">,</span> <span class="n">collate_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prepare_dict_or_graph</span><span class="o">=</span><span class="s1">&#39;pyg:graph&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.GraphOGBDataModule.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Load an OGB (Open-graph-benchmark) GraphProp dataset.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>task_specific_args</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="graphium.data.datamodule.DatasetProcessingParams" href="#graphium.data.datamodule.DatasetProcessingParams">DatasetProcessingParams</a>, <span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arguments related to each task, with the task-name being the key,
and the specific arguments being the values. The arguments must be a
Dict containing the following keys:</p>
<ul>
<li>"dataset_name": Name of the OGB dataset to load. Examples of possible datasets are
"ogbg-molhiv", "ogbg-molpcba", "ogbg-moltox21", "ogbg-molfreesolv".</li>
<li>"sample_size": The number of molecules to sample from the dataset. Default=None,
meaning that all molecules will be considered.</li>
</ul>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>processed_graph_data_path</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the processed graph data. If None, the data will be
downloaded from the OGB website.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dataloading_from</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to load the data from RAM or disk. Default is "ram".</p>
            </div>
          </td>
          <td>
                <code>&#39;ram&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>], omegaconf.<span title="omegaconf.DictConfig">DictConfig</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>args to apply to the SMILES to Graph featurizer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size_training</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>batch size for training and val dataset.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size_inference</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>batch size for test dataset.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr>
          <td><code>num_workers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of workers for the dataloader. Use -1 to use all available
cores.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>pin_memory</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to pin on paginated CPU memory for the dataloader.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization_n_jobs</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of cores to use for the featurization.</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether to show a progress bar during featurization.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization_backend</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The backend to use for the molecular featurization.</p>
<ul>
<li>"multiprocessing": Found to cause less memory issues.</li>
<li>"loky": joblib's Default. Found to cause memory leaks.</li>
<li>"threading": Found to be slow.</li>
</ul>
            </div>
          </td>
          <td>
                <code>&#39;loky&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>collate_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A custom torch collate function. Default is to <code>graphium.data.graphium_collate_fn</code></p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sample_size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <ul>
<li><code>int</code>: The maximum number of elements to take from the dataset.</li>
<li><code>float</code>: Value between 0 and 1 representing the fraction of the dataset to consider</li>
<li><code>None</code>: all elements are considered.</li>
</ul>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.GraphOGBDataModule.to_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

<a href="#graphium.data.datamodule.GraphOGBDataModule.to_dict" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>geenrate a dictionary representation of the class</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dictionary representation of the class</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.data.datamodule.IPUDataModuleModifier" class="doc doc-heading">
          <code>IPUDataModuleModifier</code>


<a href="#graphium.data.datamodule.IPUDataModuleModifier" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">



  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.IPUDataModuleModifier.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ipu_inference_opts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ipu_training_opts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ipu_dataloader_training_opts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ipu_dataloader_inference_opts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.IPUDataModuleModifier.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>wrapper functions from the a <code>DataModule</code> to support IPU and IPU options To be used in dual inheritance, for example:
<div class="highlight"><pre><span></span><code>IPUDataModule(BaseDataModule, IPUDataModuleModifier):
    def __init__(self, **kwargs):
        BaseDataModule.__init__(self, **kwargs)
        IPUDataModuleModifier.__init__(self, **kwargs)
</code></pre></div></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ipu_inference_opts</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[poptorch.<span title="poptorch.Options">Options</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Options for the IPU in inference mode. Ignore if not using IPUs</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>ipu_training_opts</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[poptorch.<span title="poptorch.Options">Options</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Options for the IPU in training mode. Ignore if not using IPUs</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>ipu_dataloader_kwargs_train_val</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Options for the dataloader for the IPU. Ignore if not using IPUs</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ipu_dataloader_kwargs_test</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Options for the dataloader for the IPU. Ignore if not using IPUs</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arguments for the <code>DataModule</code></p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments for the <code>DataModule</code></p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="graphium.data.datamodule.MultitaskFromSmilesDataModule" class="doc doc-heading">
          <code>MultitaskFromSmilesDataModule</code>


<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="graphium.data.datamodule.BaseDataModule" href="#graphium.data.datamodule.BaseDataModule">BaseDataModule</a></code>, <code><a class="autorefs autorefs-internal" title="graphium.data.datamodule.IPUDataModuleModifier" href="#graphium.data.datamodule.IPUDataModuleModifier">IPUDataModuleModifier</a></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.in_dims" class="doc doc-heading">
<code class="highlight language-python"><span class="n">in_dims</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.in_dims" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return all input dimensions for the set of graphs.
Including node/edge features, and
raw positional encoding dimensions such eigval, eigvec, rwse and more</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.num_edge_feats" class="doc doc-heading">
<code class="highlight language-python"><span class="n">num_edge_feats</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.num_edge_feats" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return the number of edge features in the first graph</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.num_node_feats" class="doc doc-heading">
<code class="highlight language-python"><span class="n">num_node_feats</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.num_node_feats" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Return the number of node features in the first graph</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">task_specific_args</span><span class="p">,</span> <span class="n">processed_graph_data_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataloading_from</span><span class="o">=</span><span class="s1">&#39;ram&#39;</span><span class="p">,</span> <span class="n">featurization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size_training</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">batch_size_inference</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">batch_size_per_pack</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">persistent_workers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">featurization_n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">featurization_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">featurization_backend</span><span class="o">=</span><span class="s1">&#39;loky&#39;</span><span class="p">,</span> <span class="n">featurization_batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">collate_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prepare_dict_or_graph</span><span class="o">=</span><span class="s1">&#39;pyg:graph&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__init__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>only for parameters beginning with task_*, we have a dictionary where the key is the task name
and the value is specified below.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>task_df</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) a dataframe</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_df_path</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) a path to a dataframe to load (CSV file). <code>df</code> takes precedence over
<code>df_path</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_smiles_col</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) Name of the SMILES column. If set to <code>None</code>, it will look for
a column with the word "smile" (case insensitive) in it.
If no such column is found, an error will be raised.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_label_cols</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) Name of the columns to use as labels, with different options.</p>
<ul>
<li><code>list</code>: A list of all column names to use</li>
<li><code>None</code>: All the columns are used except the SMILES one.</li>
<li><code>str</code>: The name of the single column to use</li>
<li><code>*str</code>: A string starting by a <code>*</code> means all columns whose name
  ends with the specified <code>str</code></li>
<li><code>str*</code>: A string ending by a <code>*</code> means all columns whose name
  starts with the specified <code>str</code></li>
</ul>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_weights_col</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) Name of the column to use as sample weights. If <code>None</code>, no
weights are used. This parameter cannot be used together with <code>weights_type</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_weights_type</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) The type of weights to use. This parameter cannot be used together with <code>weights_col</code>.
<strong>It only supports multi-label binary classification.</strong></p>
<p>Supported types:</p>
<ul>
<li><code>None</code>: No weights are used.</li>
<li><code>"sample_balanced"</code>: A weight is assigned to each sample inversely
    proportional to the number of positive value. If there are multiple
    labels, the product of the weights is used.</li>
<li><code>"sample_label_balanced"</code>: Similar to the <code>"sample_balanced"</code> weights,
    but the weights are applied to each element individually, without
    computing the product of the weights for a given sample.</li>
</ul>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_idx_col</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) Name of the columns to use as indices. Unused if set to None.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_sample_size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value)</p>
<ul>
<li><code>int</code>: The maximum number of elements to take from the dataset.</li>
<li><code>float</code>: Value between 0 and 1 representing the fraction of the dataset to consider</li>
<li><code>None</code>: all elements are considered.</li>
</ul>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_split_val</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) Ratio for the validation split.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_split_test</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) Ratio for the test split.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_seed</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) Seed to use for the random split and subsampling. More complex splitting strategy
should be implemented.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_splits_path</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(value) A path a CSV file containing indices for the splits. The file must contains
3 columns "train", "val" and "test". It takes precedence over <code>split_val</code> and <code>split_test</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>processed_graph_data_path</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>path where to save or reload the cached data. Can be used
to avoid recomputing the featurization, or for dataloading from disk with the option <code>dataloader_from="disk"</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dataloading_from</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to load the data from RAM or from disk. If set to "disk", the data
must have been previously cached with <code>processed_graph_data_path</code> set. If set to "ram", the data
will be loaded in RAM and the <code>processed_graph_data_path</code> will be ignored.</p>
            </div>
          </td>
          <td>
                <code>&#39;ram&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>], omegaconf.<span title="omegaconf.DictConfig">DictConfig</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>args to apply to the SMILES to Graph featurizer.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size_training</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>batch size for training and val dataset.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size_inference</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>batch size for test dataset.</p>
            </div>
          </td>
          <td>
                <code>16</code>
          </td>
        </tr>
        <tr>
          <td><code>num_workers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of workers for the dataloader. Use -1 to use all available
cores.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>pin_memory</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to pin on paginated CPU memory for the dataloader.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization_n_jobs</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of cores to use for the featurization.</p>
            </div>
          </td>
          <td>
                <code>-1</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether to show a progress bar during featurization.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization_backend</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The backend to use for the molecular featurization.</p>
<ul>
<li>"multiprocessing": Found to cause less memory issues.</li>
<li>"loky": joblib's Default. Found to cause memory leaks.</li>
<li>"threading": Found to be slow.</li>
</ul>
            </div>
          </td>
          <td>
                <code>&#39;loky&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>featurization_batch_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Batch size to use for the featurization.</p>
            </div>
          </td>
          <td>
                <code>1000</code>
          </td>
        </tr>
        <tr>
          <td><code>collate_fn</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A custom torch collate function. Default is to <code>graphium.data.graphium_collate_fn</code></p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>prepare_dict_or_graph</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to preprocess all molecules as Graph dict or PyG graphs.
Possible options:</p>
<ul>
<li>"pyg:dict": Process molecules as a <code>dict</code>. It's faster and requires less RAM during
  pre-processing. It is slower during training with with <code>num_workers=0</code> since
  pyg <code>Data</code> will be created during data-loading, but faster with large
  <code>num_workers</code>, and less likely to cause memory issues with the parallelization.</li>
<li>"pyg:graph": Process molecules as <code>pyg.data.Data</code>.</li>
</ul>
            </div>
          </td>
          <td>
                <code>&#39;pyg:graph&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.__len__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__len__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns the number of elements of the current DataModule, which is the combined size of all single-task datasets given.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>num_elements</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of elements in the current DataModule</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.__repr__" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Controls how the class is printed</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.calculate_statistics" class="doc doc-heading">
<code class="highlight language-python"><span class="n">calculate_statistics</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.calculate_statistics" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Calculate the statistics of the labels for each task, and overwrites the <code>self.task_norms</code> attribute.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dataset</code></td>
          <td>
                <code><span title="graphium">Datasets</span>.<span title="graphium.MultitaskDataset">MultitaskDataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dataset to calculate the statistics from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>train</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether the dataset is the training set</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.get_data_cache_fullname" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_data_cache_fullname</span><span class="p">(</span><span class="n">compress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_data_cache_fullname" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Create a hash for the dataset, and use it to generate a file name</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>compress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to compress the data</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>full path to the data cache file</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.get_data_hash" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_data_hash</span><span class="p">()</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_data_hash" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get a hash specific to a dataset and smiles_transformer.
Useful to cache the pre-processed data.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.get_dataloader" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_dataloader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">shuffle</span><span class="p">,</span> <span class="n">stage</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_dataloader" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the poptorch dataloader for a given dataset</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dataset</code></td>
          <td>
                <code><span title="torch.utils.data.dataloader.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dataset from which to load the data</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shuffle</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>set to <code>True</code> to have the data reshuffled at every epoch.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stage</code></td>
          <td>
                <code><span title="lightning.pytorch.trainer.states.RunningStage">RunningStage</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether in Training, Validating, Testing, Sanity-checking, Predicting, or Tuning phase.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="torch.utils.data.dataloader.DataLoader">DataLoader</span>, poptorch.<span title="poptorch.DataLoader">DataLoader</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The poptorch dataloader to sample from</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.get_dataloader_kwargs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_dataloader_kwargs</span><span class="p">(</span><span class="n">stage</span><span class="p">,</span> <span class="n">shuffle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_dataloader_kwargs" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the options for the dataloader depending on the current stage.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stage</code></td>
          <td>
                <code><span title="lightning.pytorch.trainer.states.RunningStage">RunningStage</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether in Training, Validating, Testing, Sanity-checking, Predicting, or Tuning phase.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shuffle</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>set to <code>True</code> to have the data reshuffled at every epoch.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arguments to pass to the <code>DataLoader</code> during initialization</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.get_fake_graph" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_fake_graph</span><span class="p">()</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_fake_graph" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Low memory footprint method to get the featurization of a fake graph
without reading the dataset. Useful for getting the number of node/edge features.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>graph</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A fake graph with the right featurization</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.get_label_statistics" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_label_statistics</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">data_hash</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_label_statistics" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Get the label statistics from the dataset, and save them to file, if needed.
<code>self.task_norms</code> will be modified in-place with the label statistics.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_path</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, os.<span title="os.PathLike">PathLike</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path to save and load the label statistics to. If None, no saving and loading will be done.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_hash</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the hash of the dataset generated by <code>get_data_hash()</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dataset</code></td>
          <td>
                <code><span title="graphium">Datasets</span>.<span title="graphium.MultitaskDataset">MultitaskDataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dataset to calculate the statistics from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>train</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether the dataset is the training set</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.get_subsets_of_datasets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_subsets_of_datasets</span><span class="p">(</span><span class="n">single_task_datasets</span><span class="p">,</span> <span class="n">task_train_indices</span><span class="p">,</span> <span class="n">task_val_indices</span><span class="p">,</span> <span class="n">task_test_indices</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.get_subsets_of_datasets" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>From a dictionary of datasets and their associated indices, subset the train/val/test sets</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>single_task_datasets</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="graphium">Datasets</span>.<span title="graphium.SingleTaskDataset">SingleTaskDataset</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of datasets</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_train_indices</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Iterable">Iterable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of train indices</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_val_indices</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Iterable">Iterable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of val indices</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>task_test_indices</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Iterable">Iterable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of test indices</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>train_singletask_datasets</code></td>          <td>
                <code><span title="torch.utils.data.Subset">Subset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of train subsets</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>val_singletask_datasets</code></td>          <td>
                <code><span title="torch.utils.data.Subset">Subset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of val subsets</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>test_singletask_datasets</code></td>          <td>
                <code><span title="torch.utils.data.Subset">Subset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary of test subsets</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.load_data_from_cache" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_data_from_cache</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.load_data_from_cache" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Load the datasets from cache. First create a hash for the dataset, and verify if that
hash is available at the path given by <code>self.processed_graph_data_path</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to print the progress</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>compress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to compress the data</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>cache_data_exists</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the cache exists (if the hash matches) and the loading succeeded</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.normalize_label" class="doc doc-heading">
<code class="highlight language-python"><span class="n">normalize_label</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">stage</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.normalize_label" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Normalize the labels in the dataset using the statistics in <code>self.task_norms</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dataset</code></td>
          <td>
                <code><span title="graphium">Datasets</span>.<span title="graphium.MultitaskDataset">MultitaskDataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dataset to normalize the labels from</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="graphium">Datasets</span>.<span title="graphium.MultitaskDataset">MultitaskDataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the dataset with normalized labels</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.prepare_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prepare_data</span><span class="p">(</span><span class="n">save_smiles_and_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.prepare_data" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Called only from a single process in distributed settings. Steps:</p>
<ul>
<li>If each cache is set and exists, reload from cache and return. Otherwise,</li>
<li>For each single-task dataset:<ul>
<li>Load its dataframe from a path (if provided)</li>
<li>Subsample the dataframe</li>
<li>Extract the smiles, labels from the dataframe</li>
</ul>
</li>
<li>In the previous step, we were also able to get the unique smiles, which we use to compute the features</li>
<li>For each single-task dataframe and associated data (smiles, labels, etc.):<ul>
<li>Filter out the data corresponding to molecules which failed featurization.</li>
<li>Create a corresponding SingletaskDataset</li>
<li>Split the SingletaskDataset according to the task-specific splits for train, val and test</li>
</ul>
</li>
</ul>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.setup" class="doc doc-heading">
<code class="highlight language-python"><span class="n">setup</span><span class="p">(</span><span class="n">stage</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_smiles_and_ids</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.setup" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Prepare the torch dataset. Called on every GPUs. Setting state here is ok.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stage</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Either 'fit', 'test', or None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h5 id="graphium.data.datamodule.MultitaskFromSmilesDataModule.to_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

<a href="#graphium.data.datamodule.MultitaskFromSmilesDataModule.to_dict" class="headerlink" title="Permanent link">&para;</a></h5>


  <div class="doc doc-contents ">
  
      <p>Returns a dictionary representation of the current DataModule</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>obj_repr</code></td>          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary representation of the current DataModule</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="collate-module">Collate Module<a class="headerlink" href="#collate-module" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">



<h3 id="graphium.data.collate" class="doc doc-heading">
            <code>graphium.data.collate</code>


<a href="#graphium.data.collate" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="graphium.data.collate.collage_pyg_graph" class="doc doc-heading">
<code class="highlight language-python"><span class="n">collage_pyg_graph</span><span class="p">(</span><span class="n">pyg_graphs</span><span class="p">,</span> <span class="n">batch_size_per_pack</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.data.collate.collage_pyg_graph" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Function to collate pytorch geometric graphs.
Convert all numpy types to torch
Convert edge indices to int64</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pyg_graphs</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[<span title="typing.Union">Union</span>[<span title="torch_geometric.data.Data">Data</span>, <span title="typing.Dict">Dict</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable of PyG graphs</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>batch_size_per_pack</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of graphs to pack together.
This is useful for using packing with the Transformer,</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.collate.collate_labels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">collate_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">labels_size_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels_dtype_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.data.collate.collate_labels" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Collate labels for multitask learning.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="torch_geometric.data.Data">Data</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of labels</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>labels_size_dict</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dict of the form Dict[tasks, sizes] which has task names as keys
and the size of the label tensor as value. The size of the tensor corresponds to how many
labels/values there are to predict for that task.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>labels_dtype_dict</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Note): This is an attribute of the <code>MultitaskDataset</code>.
A dictionary of the form Dict[tasks, dtypes] which has task names as keys
and the dtype of the label tensor as value. This is necessary to ensure the missing labels are added with NaNs of the right dtype</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary of the form Dict[tasks, labels] where tasks is the name of the task and labels</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>is a tensor of shape (batch_size, *labels_size_dict[task]).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.collate.collate_pyg_graph_labels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">collate_pyg_graph_labels</span><span class="p">(</span><span class="n">pyg_labels</span><span class="p">)</span></code>

<a href="#graphium.data.collate.collate_pyg_graph_labels" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Function to collate pytorch geometric labels.
Convert all numpy types to torch</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pyg_labels</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="torch_geometric.data.Data">Data</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable of PyG label Data objects</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.collate.get_expected_label_size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_expected_label_size</span><span class="p">(</span><span class="n">label_data</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">label_size</span><span class="p">)</span></code>

<a href="#graphium.data.collate.get_expected_label_size" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Determines expected label size based on the specfic graph properties
and the number of targets in the task-dataset.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.collate.graphium_collate_fn" class="doc doc-heading">
<code class="highlight language-python"><span class="n">graphium_collate_fn</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">labels_size_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels_dtype_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask_nan</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">,</span> <span class="n">do_not_collate_keys</span><span class="o">=</span><span class="p">[],</span> <span class="n">batch_size_per_pack</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#graphium.data.collate.graphium_collate_fn" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>This collate function is identical to the default
pytorch collate function but add support for <code>pyg.data.Data</code> to batch graphs.</p>
<p>Beside pyg graph collate, other objects are processed the same way
as the original torch collate function. See <a href="https://pytorch.org/docs/stable/data.html#dataloader-collate-fn">https://pytorch.org/docs/stable/data.html#dataloader-collate-fn</a>
for more details.</p>

<details class="note" open>
  <summary>Note</summary>
  <p>If graphium needs to manipulate other tricky-to-batch objects. Support
for them should be added to this single collate function.</p>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elements</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="typing.Any">Any</span>], <span title="typing.Dict">Dict</span>[str, <span title="typing.List">List</span>[<span title="typing.Any">Any</span>]]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The elements to batch. See <code>torch.utils.data.dataloader.default_collate</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>labels_size_dict</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Note): This is an attribute of the <code>MultitaskDataset</code>.
A dictionary of the form Dict[tasks, sizes] which has task names as keys
and the size of the label tensor as value. The size of the tensor corresponds to how many
labels/values there are to predict for that task.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>labels_dtype_dict</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Note): This is an attribute of the <code>MultitaskDataset</code>.
A dictionary of the form Dict[tasks, dtypes] which has task names as keys
and the dtype of the label tensor as value. This is necessary to ensure the missing labels are added with NaNs of the right dtype</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>mask_nan</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, float, <span title="typing.Type">Type</span>[None]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Deal with the NaN/Inf when calling the function <code>make_pyg_graph</code>.
Some values become <code>Inf</code> when changing data type. This allows to deal
with that.</p>
<ul>
<li>"raise": Raise an error when there is a nan or inf in the featurization</li>
<li>"warn": Raise a warning when there is a nan or inf in the featurization</li>
<li>"None": DEFAULT. Don't do anything</li>
<li>"Floating value": Replace nans or inf by the specified value</li>
</ul>
            </div>
          </td>
          <td>
                <code>&#39;raise&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>do_not_batch_keys</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keys to ignore for the collate</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>batch_size_per_pack</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of graphs to pack together.
This is useful for using packing with the Transformer.
If None, no packing is done.
Otherwise, indices are generated to map the nodes to the pack they belong to under the key <code>"pack_from_node_idx"</code>,
with an additional mask to indicate which nodes are from the same graph under the key <code>"pack_attn_mask"</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="typing.Any">Any</span>, <span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The batched elements. See <code>torch.utils.data.dataloader.default_collate</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.collate.pad_nodepairs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pad_nodepairs</span><span class="p">(</span><span class="n">pe</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="n">max_num_nodes_per_graph</span><span class="p">)</span></code>

<a href="#graphium.data.collate.pad_nodepairs" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>This function zero-pads nodepair-level positional encodings to conform with the batching logic.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>pe</code></td>
          <td>
                <code>(torch.<span title="torch.Tensor">Tensor</span>, [num_nodes, num_nodes, num_feat])</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Nodepair pe</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>num_nodes</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of nodes of processed graph</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_num_nodes_per_graph</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Maximum number of nodes among graphs in current batch</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>padded_pe</code></td>          <td>
                <code>(torch.<span title="torch.Tensor">Tensor</span>, [num_nodes, max_num_nodes_per_graph, num_feat])</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>padded nodepair pe tensor</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.collate.pad_to_expected_label_size" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pad_to_expected_label_size</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">label_size</span><span class="p">)</span></code>

<a href="#graphium.data.collate.pad_to_expected_label_size" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Determine difference of <code>labels</code> shape to expected shape <code>label_size</code> and pad
with <code>torch.nan</code> accordingly.</p>

  </div>

</div>



  </div>

  </div>

</div><h2 id="util-functions">Util Functions<a class="headerlink" href="#util-functions" title="Permanent link">&para;</a></h2>
<hr />


<div class="doc doc-object doc-module">



<h3 id="graphium.data.utils" class="doc doc-heading">
            <code>graphium.data.utils</code>


<a href="#graphium.data.utils" class="headerlink" title="Permanent link">&para;</a></h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="graphium.data.utils.download_graphium_dataset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">download_graphium_dataset</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">extract_zip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#graphium.data.utils.download_graphium_dataset" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Download a Graphium dataset to a specified location.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the Graphium dataset from <code>graphium.data.utils.get_graphium_datasets()</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Directory path where to download the dataset to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>extract_zip</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to extract the dataset if it's a zip file.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to show a progress bar during download.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the downloaded dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.utils.found_size_mismatch" class="doc doc-heading">
<code class="highlight language-python"><span class="n">found_size_mismatch</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">smiles</span><span class="p">)</span></code>

<a href="#graphium.data.utils.found_size_mismatch" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Check if a size mismatch exists between features and labels with respect to node/edge/nodepair.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>task</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The task name is needed to determine the task level (graph, node, edge or nodepair)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>features</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="torch_geometric.data.Data">Data</span>, <a class="autorefs autorefs-internal" title="graphium.features.featurizer.GraphDict" href="graphium.features.html#graphium.features.featurizer.GraphDict">GraphDict</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Features/information of molecule/graph (e.g., edge_index, feat, edge_feat, num_nodes, etc.)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Target label of molecule for the task</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>smiles</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Smiles string of molecule</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>mismatch</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Boolean variable indicating if a size mismatch was found between featurs and labels.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.utils.graphium_package_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">graphium_package_path</span><span class="p">(</span><span class="n">graphium_path</span><span class="p">)</span></code>

<a href="#graphium.data.utils.graphium_package_path" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return the path of a graphium file in the package.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.utils.list_graphium_datasets" class="doc doc-heading">
<code class="highlight language-python"><span class="n">list_graphium_datasets</span><span class="p">()</span></code>

<a href="#graphium.data.utils.list_graphium_datasets" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>List Graphium datasets available to download.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>set</code></td>          <td>
                <code>set</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A set of Graphium dataset names.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.utils.load_micro_zinc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_micro_zinc</span><span class="p">()</span></code>

<a href="#graphium.data.utils.load_micro_zinc" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return a dataframe of micro ZINC (1000 data points).</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pd.DataFrame: A dataframe of micro ZINC.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="graphium.data.utils.load_tiny_zinc" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_tiny_zinc</span><span class="p">()</span></code>

<a href="#graphium.data.utils.load_tiny_zinc" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return a dataframe of tiny ZINC (100 data points).</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pd.DataFrame: A dataframe of tiny ZINC.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2020 - 2023 datamol.io
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.expand"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
        
          <script src="../_assets/js/google-analytics.js"></script>
        
      
    
  </body>
</html>